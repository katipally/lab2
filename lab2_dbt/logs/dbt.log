[0m02:47:23.043624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD835BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ADB437FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ADB437DC0>]}


============================== 02:47:23.043624 | 778cca85-a4d2-4b9a-9b53-a30a569bcaac ==============================
[0m02:47:23.043624 [info ] [MainThread]: Running with dbt=1.8.7
[0m02:47:23.059555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\yashw\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:47:23.092711 [info ] [MainThread]: dbt version: 1.8.7
[0m02:47:23.093738 [info ] [MainThread]: python version: 3.10.11
[0m02:47:23.094775 [info ] [MainThread]: python path: C:\Users\yashw\AppData\Local\Programs\Python\Python310\python.exe
[0m02:47:23.095293 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m02:47:24.197445 [info ] [MainThread]: Using profiles dir at C:\Users\yashw\.dbt
[0m02:47:24.197445 [info ] [MainThread]: Using profiles.yml file at C:\Users\yashw\.dbt\profiles.yml
[0m02:47:24.197445 [info ] [MainThread]: Using dbt_project.yml file at D:\study\SJSU\SEM_1\Data_Warehouse-data_226\Lab2\airflow\lab2_dbt\dbt_project.yml
[0m02:47:24.204487 [info ] [MainThread]: adapter type: snowflake
[0m02:47:24.204487 [info ] [MainThread]: adapter version: 1.8.4
[0m02:47:24.284294 [info ] [MainThread]: Configuration:
[0m02:47:24.284708 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:47:24.284708 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:47:24.284708 [info ] [MainThread]: Required dependencies:
[0m02:47:24.284708 [debug] [MainThread]: Executing "git --help"
[0m02:47:24.348112 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:47:24.356128 [debug] [MainThread]: STDERR: "b''"
[0m02:47:24.356128 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:47:24.356128 [info ] [MainThread]: Connection:
[0m02:47:24.356128 [info ] [MainThread]:   account: QBB76544
[0m02:47:24.356128 [info ] [MainThread]:   user: katipally
[0m02:47:24.356128 [info ] [MainThread]:   database: lab2_db
[0m02:47:24.356128 [info ] [MainThread]:   warehouse: LAB2
[0m02:47:24.356128 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m02:47:24.356128 [info ] [MainThread]:   schema: ANALYTICS
[0m02:47:24.363536 [info ] [MainThread]:   authenticator: None
[0m02:47:24.363536 [info ] [MainThread]:   oauth_client_id: None
[0m02:47:24.363536 [info ] [MainThread]:   query_tag: None
[0m02:47:24.363536 [info ] [MainThread]:   client_session_keep_alive: False
[0m02:47:24.366547 [info ] [MainThread]:   host: None
[0m02:47:24.366547 [info ] [MainThread]:   port: None
[0m02:47:24.366547 [info ] [MainThread]:   proxy_host: None
[0m02:47:24.366547 [info ] [MainThread]:   proxy_port: None
[0m02:47:24.366547 [info ] [MainThread]:   protocol: None
[0m02:47:24.366547 [info ] [MainThread]:   connect_retries: 1
[0m02:47:24.366547 [info ] [MainThread]:   connect_timeout: None
[0m02:47:24.366547 [info ] [MainThread]:   retry_on_database_errors: False
[0m02:47:24.366547 [info ] [MainThread]:   retry_all: False
[0m02:47:24.366547 [info ] [MainThread]:   insecure_mode: False
[0m02:47:24.366547 [info ] [MainThread]:   reuse_connections: None
[0m02:47:24.366547 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m02:47:24.366547 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m02:47:24.376642 [debug] [MainThread]: Using snowflake connection "debug"
[0m02:47:24.376642 [debug] [MainThread]: On debug: select 1 as id
[0m02:47:24.376642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:47:25.586741 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.210 seconds
[0m02:47:25.586741 [debug] [MainThread]: On debug: Close
[0m02:47:25.705202 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:47:25.705202 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:47:25.705202 [debug] [MainThread]: Command `dbt debug` succeeded at 02:47:25.705202 after 2.77 seconds
[0m02:47:25.705202 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:47:25.712243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD835BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AFC6A14E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AFC6EBD60>]}
[0m02:47:25.712243 [debug] [MainThread]: Flushing usage events
[0m03:05:50.136138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE7D37BDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE7FC4FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE7FC4FF70>]}


============================== 03:05:50.136138 | 29380f9b-4a54-4f92-9929-7eb9b54b5de8 ==============================
[0m03:05:50.136138 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:05:50.146557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m03:05:50.146557 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'DBT_ACCOUNT'
[0m03:05:50.157009 [debug] [MainThread]: Command `dbt run` failed at 03:05:50.157009 after 0.19 seconds
[0m03:05:50.157009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE7D37BDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE7FC4EA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE7FC4CD30>]}
[0m03:05:50.157009 [debug] [MainThread]: Flushing usage events
[0m03:06:18.862829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB2B83BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB2E860970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB2E8606A0>]}


============================== 03:06:18.870856 | 2d1a15ea-a28c-420a-8e09-48d69a2a2d3d ==============================
[0m03:06:18.870856 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:06:18.870856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'debug': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:06:18.872862 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | lab2_dbt:
    2  |   outputs:
    3  |     dev:
    4  |       account: {{ env_var('DBT_ACCOUNT') }}
    5  |       database: "{{ env_var('DBT_DATABASE') }}"
    6  |       password: "{{ env_var('DBT_PASSWORD') }}"
    7  |       role: "{{ env_var('DBT_ROLE') }}"
    
    Raw Error:
    ------------------------------
    while constructing a mapping
      in "<unicode string>", line 4, column 16
    found unhashable key
      in "<unicode string>", line 4, column 17
  
[0m03:06:18.872862 [debug] [MainThread]: Command `dbt run` failed at 03:06:18.872862 after 0.08 seconds
[0m03:06:18.872862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB2B83BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB2E8623B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB2E8623E0>]}
[0m03:06:18.872862 [debug] [MainThread]: Flushing usage events
[0m03:08:19.717999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4962BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4C6BFBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4C6BFF10>]}


============================== 03:08:19.717999 | 5821b240-697e-4c25-aeba-bddc82604e7e ==============================
[0m03:08:19.717999 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:08:19.717999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:08:21.117152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5821b240-697e-4c25-aeba-bddc82604e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6D84F8B0>]}
[0m03:08:21.167831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5821b240-697e-4c25-aeba-bddc82604e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4C21E890>]}
[0m03:08:21.167831 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:08:21.178878 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:08:21.178878 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:08:21.178878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5821b240-697e-4c25-aeba-bddc82604e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4C652440>]}
[0m03:08:22.445255 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:08:22.452524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5821b240-697e-4c25-aeba-bddc82604e7e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6DAE1780>]}
[0m03:08:22.599066 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.lab2_dbt.input_stock_data' (models\input\input_stock_data.sql) depends on a source named 'raw_data.stock_prices' which was not found
[0m03:08:22.599066 [debug] [MainThread]: Command `dbt run` failed at 03:08:22.599066 after 2.99 seconds
[0m03:08:22.599066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4962BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6DD7EF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB6DD7F340>]}
[0m03:08:22.599066 [debug] [MainThread]: Flushing usage events
[0m03:11:33.026010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019661DABDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019664E7FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019664E7FF40>]}


============================== 03:11:33.027524 | 37c88315-5055-43c0-9b30-b53931568675 ==============================
[0m03:11:33.027524 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:11:33.027524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:11:34.408552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019606052980>]}
[0m03:11:34.459180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019664D05540>]}
[0m03:11:34.459180 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:11:34.469207 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:11:34.469207 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:11:34.469207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019664CAE9B0>]}
[0m03:11:35.691255 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:11:35.691255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196065B68F0>]}
[0m03:11:36.010208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_dbt.example
[0m03:11:36.021747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196068A4EE0>]}
[0m03:11:36.233628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196068A56C0>]}
[0m03:11:36.233628 [info ] [MainThread]: Found 3 models, 2 snapshots, 18 data tests, 1 source, 459 macros
[0m03:11:36.233628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019606883280>]}
[0m03:11:36.233628 [info ] [MainThread]: 
[0m03:11:36.233628 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:11:36.244449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db'
[0m03:11:36.254458 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db"
[0m03:11:36.259482 [debug] [ThreadPool]: On list_lab2_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db"} */
show terse schemas in database lab2_db
    limit 10000
[0m03:11:36.259482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:37.433462 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.177 seconds
[0m03:11:37.433462 [debug] [ThreadPool]: On list_lab2_db: Close
[0m03:11:37.559359 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db_analytics'
[0m03:11:37.565867 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_analytics"
[0m03:11:37.565867 [debug] [ThreadPool]: On list_lab2_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_analytics"} */
show objects in lab2_db.analytics limit 10000
[0m03:11:37.565867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:11:38.535660 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.963 seconds
[0m03:11:38.537668 [debug] [ThreadPool]: On list_lab2_db_analytics: Close
[0m03:11:38.653383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db_analytics, now list_lab2_db_snapshots)
[0m03:11:38.664621 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_snapshots"
[0m03:11:38.664621 [debug] [ThreadPool]: On list_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_snapshots"} */
show objects in lab2_db.snapshots limit 10000
[0m03:11:38.664621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:11:39.736198 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85d3f-0004-2cf3-0002-655b00021082
[0m03:11:39.737710 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:11:39.737710 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:11:39.737710 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:11:39.737710 [debug] [ThreadPool]: On list_lab2_db_snapshots: Close
[0m03:11:39.852325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019661B3EB00>]}
[0m03:11:39.852325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:11:39.852325 [info ] [MainThread]: 
[0m03:11:39.873286 [debug] [Thread-1 (]: Began running node model.lab2_dbt.input_stock_data
[0m03:11:39.873286 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.input_stock_data ......................... [RUN]
[0m03:11:39.873286 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab2_dbt.input_stock_data'
[0m03:11:39.873286 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.input_stock_data
[0m03:11:39.883323 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.input_stock_data"
[0m03:11:39.897568 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.input_stock_data
[0m03:11:39.923642 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.input_stock_data"
[0m03:11:39.926182 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.input_stock_data"
[0m03:11:39.926182 [debug] [Thread-1 (]: On model.lab2_dbt.input_stock_data: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.input_stock_data"} */
create or replace   view lab2_db.analytics.input_stock_data
  
   as (
    select * from lab2_db.raw_data.stock_prices
  );
[0m03:11:39.926182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:11:41.255478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.327 seconds
[0m03:11:41.275560 [debug] [Thread-1 (]: On model.lab2_dbt.input_stock_data: Close
[0m03:11:41.376466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196064C1DE0>]}
[0m03:11:41.381038 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.input_stock_data .................... [[32mSUCCESS 1[0m in 1.50s]
[0m03:11:41.381038 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.input_stock_data
[0m03:11:41.381038 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average_7d
[0m03:11:41.381038 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.moving_average_7d ........................ [RUN]
[0m03:11:41.381038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.input_stock_data, now model.lab2_dbt.moving_average_7d)
[0m03:11:41.381038 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average_7d
[0m03:11:41.391051 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average_7d"
[0m03:11:41.391051 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.moving_average_7d
[0m03:11:41.396586 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.moving_average_7d"
[0m03:11:41.403974 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.moving_average_7d"
[0m03:11:41.403974 [debug] [Thread-1 (]: On model.lab2_dbt.moving_average_7d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.moving_average_7d"} */
create or replace   view lab2_db.analytics.moving_average_7d
  
   as (
    select
    symbol,
    date,
    close,
    avg(close) over (
        partition by symbol
        order by date
        rows between 6 preceding and current row
    ) as moving_average_7d
from lab2_db.analytics.input_stock_data
  );
[0m03:11:41.404994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:11:42.706646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.304 seconds
[0m03:11:42.706646 [debug] [Thread-1 (]: On model.lab2_dbt.moving_average_7d: Close
[0m03:11:42.822469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019606428CD0>]}
[0m03:11:42.822469 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.moving_average_7d ................... [[32mSUCCESS 1[0m in 1.44s]
[0m03:11:42.832565 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average_7d
[0m03:11:42.832565 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi_7d
[0m03:11:42.832565 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi_7d ................................... [RUN]
[0m03:11:42.832565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average_7d, now model.lab2_dbt.rsi_7d)
[0m03:11:42.832565 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi_7d
[0m03:11:42.840572 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi_7d"
[0m03:11:42.844587 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.rsi_7d
[0m03:11:42.848611 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.rsi_7d"
[0m03:11:42.854617 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.rsi_7d"
[0m03:11:42.854617 [debug] [Thread-1 (]: On model.lab2_dbt.rsi_7d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.rsi_7d"} */
create or replace   view lab2_db.analytics.rsi_7d
  
   as (
    with price_changes as (
    select
        symbol,
        date,
        close,
        lag(close) over (partition by symbol order by date) as previous_close,
        case
            when close > lag(close) over (partition by symbol order by date) then close - lag(close) over (partition by symbol order by date)
            else 0
        end as gain,
        case
            when close < lag(close) over (partition by symbol order by date) then lag(close) over (partition by symbol order by date) - close
            else 0
        end as loss
    from lab2_db.analytics.input_stock_data
),
avg_gains_losses as (
    select
        symbol,
        date,
        avg(gain) over (
            partition by symbol
            order by date
            rows between 6 preceding and current row
        ) as avg_gain,
        avg(loss) over (
            partition by symbol
            order by date
            rows between 6 preceding and current row
        ) as avg_loss
    from price_changes
)
select
    symbol,
    date,
    100 - (100 / (1 + (avg_gain / nullif(avg_loss, 0)))) as rsi_7d
from avg_gains_losses
  );
[0m03:11:42.854617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:11:44.034607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.180 seconds
[0m03:11:44.040124 [debug] [Thread-1 (]: On model.lab2_dbt.rsi_7d: Close
[0m03:11:44.153844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c88315-5055-43c0-9b30-b53931568675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019606429E40>]}
[0m03:11:44.161359 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi_7d .............................. [[32mSUCCESS 1[0m in 1.32s]
[0m03:11:44.163867 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi_7d
[0m03:11:44.163867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:11:44.163867 [debug] [MainThread]: Connection 'list_lab2_db' was properly closed.
[0m03:11:44.163867 [debug] [MainThread]: Connection 'list_lab2_db_snapshots' was properly closed.
[0m03:11:44.163867 [debug] [MainThread]: Connection 'model.lab2_dbt.rsi_7d' was properly closed.
[0m03:11:44.163867 [info ] [MainThread]: 
[0m03:11:44.163867 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.93 seconds (7.93s).
[0m03:11:44.173920 [debug] [MainThread]: Command end result
[0m03:11:44.273783 [info ] [MainThread]: 
[0m03:11:44.273783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:11:44.273783 [info ] [MainThread]: 
[0m03:11:44.273783 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m03:11:44.273783 [debug] [MainThread]: Command `dbt run` succeeded at 03:11:44.273783 after 11.36 seconds
[0m03:11:44.273783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019661DABDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019661B3EB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019606883C70>]}
[0m03:11:44.283794 [debug] [MainThread]: Flushing usage events
[0m03:13:21.255967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A27ABDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A503FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A503FF10>]}


============================== 03:13:21.255967 | dc134dc9-6d11-48a7-af8b-ca4e73619d16 ==============================
[0m03:13:21.255967 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:13:21.255967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m03:13:22.548333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc134dc9-6d11-48a7-af8b-ca4e73619d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131C61FB8B0>]}
[0m03:13:22.594810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc134dc9-6d11-48a7-af8b-ca4e73619d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A4B9EDA0>]}
[0m03:13:22.594810 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:13:22.606475 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:13:22.897372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:13:22.897372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:13:22.907483 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_dbt.example
[0m03:13:22.957638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc134dc9-6d11-48a7-af8b-ca4e73619d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131C65F4130>]}
[0m03:13:23.263355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc134dc9-6d11-48a7-af8b-ca4e73619d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131C661FA00>]}
[0m03:13:23.263355 [info ] [MainThread]: Found 3 models, 2 snapshots, 18 data tests, 1 source, 459 macros
[0m03:13:23.263355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc134dc9-6d11-48a7-af8b-ca4e73619d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131C64E81C0>]}
[0m03:13:23.273739 [info ] [MainThread]: 
[0m03:13:23.273739 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:13:23.283758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db_analytics'
[0m03:13:23.293998 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_analytics"
[0m03:13:23.293998 [debug] [ThreadPool]: On list_lab2_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_analytics"} */
show objects in lab2_db.analytics limit 10000
[0m03:13:23.293998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:24.458245 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.166 seconds
[0m03:13:24.467165 [debug] [ThreadPool]: On list_lab2_db_analytics: Close
[0m03:13:24.569365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db_analytics, now list_lab2_db_snapshots)
[0m03:13:24.574902 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_snapshots"
[0m03:13:24.574902 [debug] [ThreadPool]: On list_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_snapshots"} */
show objects in lab2_db.snapshots limit 10000
[0m03:13:24.574902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:25.561989 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85d41-0004-2cf3-0002-655b000210be
[0m03:13:25.561989 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:13:25.561989 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:13:25.561989 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:13:25.561989 [debug] [ThreadPool]: On list_lab2_db_snapshots: Close
[0m03:13:25.676595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc134dc9-6d11-48a7-af8b-ca4e73619d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A253FCD0>]}
[0m03:13:25.676595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:25.679639 [info ] [MainThread]: 
[0m03:13:25.686841 [debug] [Thread-1 (]: Began running node test.lab2_dbt.accepted_range_rsi_7d_rsi_7d__100__0.71fd25fb2f
[0m03:13:25.686841 [info ] [Thread-1 (]: 1 of 18 START test accepted_range_rsi_7d_rsi_7d__100__0 ........................ [RUN]
[0m03:13:25.686841 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.lab2_dbt.accepted_range_rsi_7d_rsi_7d__100__0.71fd25fb2f'
[0m03:13:25.686841 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.accepted_range_rsi_7d_rsi_7d__100__0.71fd25fb2f
[0m03:13:25.727394 [debug] [Thread-1 (]: Compilation Error in test accepted_range_rsi_7d_rsi_7d__100__0 (models\output\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:13:25.728123 [error] [Thread-1 (]: 1 of 18 ERROR accepted_range_rsi_7d_rsi_7d__100__0 ............................. [[31mERROR[0m in 0.04s]
[0m03:13:25.728123 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.accepted_range_rsi_7d_rsi_7d__100__0.71fd25fb2f
[0m03:13:25.728123 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:13:25.728123 [info ] [Thread-1 (]: 2 of 18 START test not_null_input_stock_data_close ............................. [RUN]
[0m03:13:25.728123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.accepted_range_rsi_7d_rsi_7d__100__0.71fd25fb2f, now test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f)
[0m03:13:25.728123 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:13:25.738632 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m03:13:25.743179 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:13:25.761680 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m03:13:25.761680 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m03:13:25.761680 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from lab2_db.analytics.input_stock_data
where close is null



      
    ) dbt_internal_test
[0m03:13:25.761680 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:13:27.139427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.372 seconds
[0m03:13:27.150347 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f: Close
[0m03:13:27.255758 [info ] [Thread-1 (]: 2 of 18 PASS not_null_input_stock_data_close ................................... [[32mPASS[0m in 1.53s]
[0m03:13:27.265602 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:13:27.266648 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:13:27.266648 [info ] [Thread-1 (]: 3 of 18 START test not_null_input_stock_data_date .............................. [RUN]
[0m03:13:27.266648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f, now test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817)
[0m03:13:27.266648 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:13:27.271991 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m03:13:27.277365 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:13:27.277365 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m03:13:27.277365 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m03:13:27.277365 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.input_stock_data
where date is null



      
    ) dbt_internal_test
[0m03:13:27.277365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:28.386284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.103 seconds
[0m03:13:28.386284 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817: Close
[0m03:13:28.492982 [info ] [Thread-1 (]: 3 of 18 PASS not_null_input_stock_data_date .................................... [[32mPASS[0m in 1.23s]
[0m03:13:28.492982 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:13:28.492982 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:13:28.498076 [info ] [Thread-1 (]: 4 of 18 START test not_null_input_stock_data_symbol ............................ [RUN]
[0m03:13:28.498076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817, now test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb)
[0m03:13:28.498076 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:13:28.503416 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m03:13:28.503416 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:13:28.503416 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m03:13:28.514727 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m03:13:28.514727 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.input_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m03:13:28.514727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:29.428552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.914 seconds
[0m03:13:29.428552 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb: Close
[0m03:13:29.561178 [info ] [Thread-1 (]: 4 of 18 PASS not_null_input_stock_data_symbol .................................. [[32mPASS[0m in 1.06s]
[0m03:13:29.561178 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:13:29.561178 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:13:29.561178 [info ] [Thread-1 (]: 5 of 18 START test not_null_moving_average_7d_date ............................. [RUN]
[0m03:13:29.561178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb, now test.lab2_dbt.not_null_moving_average_7d_date.6941de8714)
[0m03:13:29.561178 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:13:29.572851 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m03:13:29.572851 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:13:29.572851 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m03:13:29.582859 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m03:13:29.582859 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_date.6941de8714: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.moving_average_7d
where date is null



      
    ) dbt_internal_test
[0m03:13:29.582859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:30.864390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.280 seconds
[0m03:13:30.864390 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_date.6941de8714: Close
[0m03:13:31.002964 [info ] [Thread-1 (]: 5 of 18 PASS not_null_moving_average_7d_date ................................... [[32mPASS[0m in 1.44s]
[0m03:13:31.002964 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:13:31.002964 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1
[0m03:13:31.008493 [info ] [Thread-1 (]: 6 of 18 START test not_null_moving_average_7d_moving_average_7d ................ [RUN]
[0m03:13:31.010177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_moving_average_7d_date.6941de8714, now test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1)
[0m03:13:31.011189 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1
[0m03:13:31.017397 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1"
[0m03:13:31.020464 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1
[0m03:13:31.023479 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1"
[0m03:13:31.023479 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1"
[0m03:13:31.029485 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select moving_average_7d
from lab2_db.analytics.moving_average_7d
where moving_average_7d is null



      
    ) dbt_internal_test
[0m03:13:31.029485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:32.320836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.300 seconds
[0m03:13:32.330879 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1: Close
[0m03:13:32.430373 [info ] [Thread-1 (]: 6 of 18 PASS not_null_moving_average_7d_moving_average_7d ...................... [[32mPASS[0m in 1.42s]
[0m03:13:32.436899 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1
[0m03:13:32.436899 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:13:32.436899 [info ] [Thread-1 (]: 7 of 18 START test not_null_moving_average_7d_symbol ........................... [RUN]
[0m03:13:32.436899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_moving_average_7d_moving_average_7d.c130263da1, now test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6)
[0m03:13:32.436899 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:13:32.446940 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m03:13:32.446940 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:13:32.446940 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m03:13:32.446940 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m03:13:32.446940 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.moving_average_7d
where symbol is null



      
    ) dbt_internal_test
[0m03:13:32.446940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:33.498892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.047 seconds
[0m03:13:33.508902 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6: Close
[0m03:13:33.621210 [info ] [Thread-1 (]: 7 of 18 PASS not_null_moving_average_7d_symbol ................................. [[32mPASS[0m in 1.18s]
[0m03:13:33.625719 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:13:33.625719 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:13:33.625719 [info ] [Thread-1 (]: 8 of 18 START test not_null_rsi_7d_date ........................................ [RUN]
[0m03:13:33.625719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6, now test.lab2_dbt.not_null_rsi_7d_date.07452c994a)
[0m03:13:33.631235 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:13:33.631235 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m03:13:33.631235 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:13:33.641869 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m03:13:33.647452 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m03:13:33.647452 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_date.07452c994a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.rsi_7d
where date is null



      
    ) dbt_internal_test
[0m03:13:33.647452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:34.891926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.240 seconds
[0m03:13:34.891926 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_date.07452c994a: Close
[0m03:13:35.013781 [info ] [Thread-1 (]: 8 of 18 PASS not_null_rsi_7d_date .............................................. [[32mPASS[0m in 1.39s]
[0m03:13:35.018365 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:13:35.018365 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d
[0m03:13:35.018365 [info ] [Thread-1 (]: 9 of 18 START test not_null_rsi_7d_rsi_7d ...................................... [RUN]
[0m03:13:35.018365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_rsi_7d_date.07452c994a, now test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d)
[0m03:13:35.018365 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d
[0m03:13:35.028586 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d"
[0m03:13:35.043736 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d
[0m03:13:35.043736 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d"
[0m03:13:35.048743 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d"
[0m03:13:35.048743 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rsi_7d
from lab2_db.analytics.rsi_7d
where rsi_7d is null



      
    ) dbt_internal_test
[0m03:13:35.048743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:36.217200 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.164 seconds
[0m03:13:36.217200 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d: Close
[0m03:13:36.341110 [error] [Thread-1 (]: 9 of 18 FAIL 5 not_null_rsi_7d_rsi_7d .......................................... [[31mFAIL 5[0m in 1.32s]
[0m03:13:36.341110 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d
[0m03:13:36.341110 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:13:36.351160 [info ] [Thread-1 (]: 10 of 18 START test not_null_rsi_7d_symbol ..................................... [RUN]
[0m03:13:36.351160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_rsi_7d_rsi_7d.e14427f74d, now test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87)
[0m03:13:36.351160 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:13:36.356196 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m03:13:36.361207 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:13:36.361207 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m03:13:36.361207 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m03:13:36.361207 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.rsi_7d
where symbol is null



      
    ) dbt_internal_test
[0m03:13:36.361207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:37.384040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.016 seconds
[0m03:13:37.384040 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87: Close
[0m03:13:37.506484 [info ] [Thread-1 (]: 10 of 18 PASS not_null_rsi_7d_symbol ........................................... [[32mPASS[0m in 1.16s]
[0m03:13:37.511015 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:13:37.511015 [debug] [Thread-1 (]: Began running node test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f
[0m03:13:37.511015 [info ] [Thread-1 (]: 11 of 18 START test relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_  [RUN]
[0m03:13:37.511015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87, now test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f)
[0m03:13:37.511015 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f
[0m03:13:37.521539 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f"
[0m03:13:37.521539 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f
[0m03:13:37.531546 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f"
[0m03:13:37.531546 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f"
[0m03:13:37.531546 [debug] [Thread-1 (]: On test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select moving_average_7d as from_field
    from lab2_db.analytics.moving_average_7d
    where moving_average_7d is not null
),

parent as (
    select  as to_field
    from lab2_db.analytics.input_stock_data
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m03:13:37.531546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:38.483920 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85d41-0004-2cee-0002-655b0001bc66
[0m03:13:38.486454 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 12 unexpected 'as'.
syntax error line 33 at position 4 unexpected ')'.
[0m03:13:38.486454 [debug] [Thread-1 (]: On test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f: Close
[0m03:13:38.602987 [debug] [Thread-1 (]: Database Error in test relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_ (models\output\schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 12 unexpected 'as'.
  syntax error line 33 at position 4 unexpected ')'.
  compiled code at target\run\lab2_dbt\models\output\schema.yml\relationships_moving_average_7_d132cb8305058bab1d7e30aef0136b81.sql
[0m03:13:38.602987 [error] [Thread-1 (]: 11 of 18 ERROR relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_  [[31mERROR[0m in 1.09s]
[0m03:13:38.602987 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f
[0m03:13:38.613000 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909
[0m03:13:38.613000 [info ] [Thread-1 (]: 12 of 18 START test source_not_null_raw_data_stock_prices_close ................ [RUN]
[0m03:13:38.613000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_.a4ed0b2d9f, now test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909)
[0m03:13:38.613000 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909
[0m03:13:38.613000 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909"
[0m03:13:38.623022 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909
[0m03:13:38.623022 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909"
[0m03:13:38.628668 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909"
[0m03:13:38.628668 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from lab2_db.raw_data.stock_prices
where close is null



      
    ) dbt_internal_test
[0m03:13:38.628668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:39.576341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.950 seconds
[0m03:13:39.576341 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909: Close
[0m03:13:39.700946 [info ] [Thread-1 (]: 12 of 18 PASS source_not_null_raw_data_stock_prices_close ...................... [[32mPASS[0m in 1.09s]
[0m03:13:39.702944 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909
[0m03:13:39.702944 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a
[0m03:13:39.703967 [info ] [Thread-1 (]: 13 of 18 START test source_not_null_raw_data_stock_prices_date ................. [RUN]
[0m03:13:39.704943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909, now test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a)
[0m03:13:39.704943 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a
[0m03:13:39.709686 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a"
[0m03:13:39.709686 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a
[0m03:13:39.717521 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a"
[0m03:13:39.717521 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a"
[0m03:13:39.717521 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.raw_data.stock_prices
where date is null



      
    ) dbt_internal_test
[0m03:13:39.717521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:40.711552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.990 seconds
[0m03:13:40.716076 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a: Close
[0m03:13:40.827148 [info ] [Thread-1 (]: 13 of 18 PASS source_not_null_raw_data_stock_prices_date ....................... [[32mPASS[0m in 1.12s]
[0m03:13:40.827148 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a
[0m03:13:40.827148 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80
[0m03:13:40.827148 [info ] [Thread-1 (]: 14 of 18 START test source_not_null_raw_data_stock_prices_symbol ............... [RUN]
[0m03:13:40.827148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a, now test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80)
[0m03:13:40.837166 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80
[0m03:13:40.843733 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80"
[0m03:13:40.847248 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80
[0m03:13:40.847248 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80"
[0m03:13:40.847248 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80"
[0m03:13:40.847248 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.raw_data.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m03:13:40.847248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:42.065624 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.213 seconds
[0m03:13:42.071153 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80: Close
[0m03:13:42.200361 [info ] [Thread-1 (]: 14 of 18 PASS source_not_null_raw_data_stock_prices_symbol ..................... [[32mPASS[0m in 1.37s]
[0m03:13:42.200361 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80
[0m03:13:42.200361 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e
[0m03:13:42.200361 [info ] [Thread-1 (]: 15 of 18 START test source_unique_raw_data_stock_prices_symbol ................. [RUN]
[0m03:13:42.210370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80, now test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e)
[0m03:13:42.210370 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e
[0m03:13:42.216965 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e"
[0m03:13:42.232626 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e
[0m03:13:42.232626 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e"
[0m03:13:42.241203 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e"
[0m03:13:42.241203 [debug] [Thread-1 (]: On test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from lab2_db.raw_data.stock_prices
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m03:13:42.241203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:43.491464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.250 seconds
[0m03:13:43.491464 [debug] [Thread-1 (]: On test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e: Close
[0m03:13:43.610438 [error] [Thread-1 (]: 15 of 18 FAIL 2 source_unique_raw_data_stock_prices_symbol ..................... [[31mFAIL 2[0m in 1.40s]
[0m03:13:43.610438 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e
[0m03:13:43.610438 [debug] [Thread-1 (]: Began running node test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb
[0m03:13:43.610438 [info ] [Thread-1 (]: 16 of 18 START test unique_input_stock_data_symbol ............................. [RUN]
[0m03:13:43.617977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e, now test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb)
[0m03:13:43.617977 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb
[0m03:13:43.620485 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb"
[0m03:13:43.620485 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb
[0m03:13:43.630528 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb"
[0m03:13:43.634061 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb"
[0m03:13:43.634061 [debug] [Thread-1 (]: On test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from lab2_db.analytics.input_stock_data
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m03:13:43.634061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:44.578628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.950 seconds
[0m03:13:44.587138 [debug] [Thread-1 (]: On test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb: Close
[0m03:13:44.680375 [error] [Thread-1 (]: 16 of 18 FAIL 2 unique_input_stock_data_symbol ................................. [[31mFAIL 2[0m in 1.06s]
[0m03:13:44.680375 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb
[0m03:13:44.689887 [debug] [Thread-1 (]: Began running node test.lab2_dbt.unique_moving_average_7d_date.a32718392a
[0m03:13:44.690397 [info ] [Thread-1 (]: 17 of 18 START test unique_moving_average_7d_date .............................. [RUN]
[0m03:13:44.692922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb, now test.lab2_dbt.unique_moving_average_7d_date.a32718392a)
[0m03:13:44.692922 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.unique_moving_average_7d_date.a32718392a
[0m03:13:44.692922 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.unique_moving_average_7d_date.a32718392a"
[0m03:13:44.701447 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.unique_moving_average_7d_date.a32718392a
[0m03:13:44.701447 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.unique_moving_average_7d_date.a32718392a"
[0m03:13:44.710420 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.unique_moving_average_7d_date.a32718392a"
[0m03:13:44.710420 [debug] [Thread-1 (]: On test.lab2_dbt.unique_moving_average_7d_date.a32718392a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.unique_moving_average_7d_date.a32718392a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from lab2_db.analytics.moving_average_7d
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m03:13:44.711930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:45.971458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.263 seconds
[0m03:13:45.976471 [debug] [Thread-1 (]: On test.lab2_dbt.unique_moving_average_7d_date.a32718392a: Close
[0m03:13:46.101700 [error] [Thread-1 (]: 17 of 18 FAIL 62 unique_moving_average_7d_date ................................. [[31mFAIL 62[0m in 1.41s]
[0m03:13:46.101700 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.unique_moving_average_7d_date.a32718392a
[0m03:13:46.101700 [debug] [Thread-1 (]: Began running node test.lab2_dbt.unique_rsi_7d_date.2416ad37fa
[0m03:13:46.101700 [info ] [Thread-1 (]: 18 of 18 START test unique_rsi_7d_date ......................................... [RUN]
[0m03:13:46.101700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.unique_moving_average_7d_date.a32718392a, now test.lab2_dbt.unique_rsi_7d_date.2416ad37fa)
[0m03:13:46.111747 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.unique_rsi_7d_date.2416ad37fa
[0m03:13:46.116292 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.unique_rsi_7d_date.2416ad37fa"
[0m03:13:46.121803 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.unique_rsi_7d_date.2416ad37fa
[0m03:13:46.121803 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.unique_rsi_7d_date.2416ad37fa"
[0m03:13:46.121803 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.unique_rsi_7d_date.2416ad37fa"
[0m03:13:46.121803 [debug] [Thread-1 (]: On test.lab2_dbt.unique_rsi_7d_date.2416ad37fa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.unique_rsi_7d_date.2416ad37fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from lab2_db.analytics.rsi_7d
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m03:13:46.121803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:47.169733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.041 seconds
[0m03:13:47.169733 [debug] [Thread-1 (]: On test.lab2_dbt.unique_rsi_7d_date.2416ad37fa: Close
[0m03:13:47.273719 [error] [Thread-1 (]: 18 of 18 FAIL 62 unique_rsi_7d_date ............................................ [[31mFAIL 62[0m in 1.17s]
[0m03:13:47.273719 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.unique_rsi_7d_date.2416ad37fa
[0m03:13:47.273719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:47.273719 [debug] [MainThread]: Connection 'list_lab2_db_snapshots' was properly closed.
[0m03:13:47.281258 [debug] [MainThread]: Connection 'test.lab2_dbt.unique_rsi_7d_date.2416ad37fa' was properly closed.
[0m03:13:47.282480 [info ] [MainThread]: 
[0m03:13:47.284026 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 24.01 seconds (24.01s).
[0m03:13:47.284026 [debug] [MainThread]: Command end result
[0m03:13:47.364453 [info ] [MainThread]: 
[0m03:13:47.364453 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m03:13:47.364453 [info ] [MainThread]: 
[0m03:13:47.364453 [error] [MainThread]:   Compilation Error in test accepted_range_rsi_7d_rsi_7d__100__0 (models\output\schema.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m03:13:47.374485 [info ] [MainThread]: 
[0m03:13:47.374485 [error] [MainThread]: [31mFailure in test not_null_rsi_7d_rsi_7d (models\output\schema.yml)[0m
[0m03:13:47.374485 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m03:13:47.374485 [info ] [MainThread]: 
[0m03:13:47.377032 [info ] [MainThread]:   compiled code at target\compiled\lab2_dbt\models\output\schema.yml\not_null_rsi_7d_rsi_7d.sql
[0m03:13:47.377032 [info ] [MainThread]: 
[0m03:13:47.377032 [error] [MainThread]:   Database Error in test relationships_moving_average_7d_moving_average_7d__ref_input_stock_data_ (models\output\schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 12 unexpected 'as'.
  syntax error line 33 at position 4 unexpected ')'.
  compiled code at target\run\lab2_dbt\models\output\schema.yml\relationships_moving_average_7_d132cb8305058bab1d7e30aef0136b81.sql
[0m03:13:47.377032 [info ] [MainThread]: 
[0m03:13:47.377032 [error] [MainThread]: [31mFailure in test source_unique_raw_data_stock_prices_symbol (models\input\source.yml)[0m
[0m03:13:47.377032 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:13:47.377032 [info ] [MainThread]: 
[0m03:13:47.377032 [info ] [MainThread]:   compiled code at target\compiled\lab2_dbt\models\input\source.yml\source_unique_raw_data_stock_prices_symbol.sql
[0m03:13:47.377032 [info ] [MainThread]: 
[0m03:13:47.384537 [error] [MainThread]: [31mFailure in test unique_input_stock_data_symbol (models\input\schema.yml)[0m
[0m03:13:47.384537 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:13:47.384537 [info ] [MainThread]: 
[0m03:13:47.384537 [info ] [MainThread]:   compiled code at target\compiled\lab2_dbt\models\input\schema.yml\unique_input_stock_data_symbol.sql
[0m03:13:47.384537 [info ] [MainThread]: 
[0m03:13:47.384537 [error] [MainThread]: [31mFailure in test unique_moving_average_7d_date (models\output\schema.yml)[0m
[0m03:13:47.384537 [error] [MainThread]:   Got 62 results, configured to fail if != 0
[0m03:13:47.384537 [info ] [MainThread]: 
[0m03:13:47.384537 [info ] [MainThread]:   compiled code at target\compiled\lab2_dbt\models\output\schema.yml\unique_moving_average_7d_date.sql
[0m03:13:47.384537 [info ] [MainThread]: 
[0m03:13:47.384537 [error] [MainThread]: [31mFailure in test unique_rsi_7d_date (models\output\schema.yml)[0m
[0m03:13:47.393058 [error] [MainThread]:   Got 62 results, configured to fail if != 0
[0m03:13:47.394564 [info ] [MainThread]: 
[0m03:13:47.394564 [info ] [MainThread]:   compiled code at target\compiled\lab2_dbt\models\output\schema.yml\unique_rsi_7d_date.sql
[0m03:13:47.394564 [info ] [MainThread]: 
[0m03:13:47.394564 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=7 SKIP=0 TOTAL=18
[0m03:13:47.398077 [debug] [MainThread]: Command `dbt test` failed at 03:13:47.398077 after 26.24 seconds
[0m03:13:47.398077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A27ABDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131A2C1CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131C6BFF130>]}
[0m03:13:47.398077 [debug] [MainThread]: Flushing usage events
[0m03:14:56.846158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002683B81BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002683E0AFBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002683E0AFF10>]}


============================== 03:14:56.854164 | cb5777d4-b35c-4b51-9293-b4b4be14ea38 ==============================
[0m03:14:56.854164 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:14:56.854164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m03:14:58.182588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb5777d4-b35c-4b51-9293-b4b4be14ea38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685F27F8B0>]}
[0m03:14:58.223918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb5777d4-b35c-4b51-9293-b4b4be14ea38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002683DC0E890>]}
[0m03:14:58.223918 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:14:58.233949 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:14:58.519682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:14:58.519682 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://models\output\schema.yml
[0m03:14:58.758472 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:14:58.758472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cb5777d4-b35c-4b51-9293-b4b4be14ea38', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685F65C880>]}
[0m03:14:58.940990 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_dbt.example
[0m03:14:58.961412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb5777d4-b35c-4b51-9293-b4b4be14ea38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685F835A20>]}
[0m03:14:59.156770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb5777d4-b35c-4b51-9293-b4b4be14ea38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685F5DB250>]}
[0m03:14:59.164777 [info ] [MainThread]: Found 3 models, 2 snapshots, 12 data tests, 1 source, 459 macros
[0m03:14:59.164777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb5777d4-b35c-4b51-9293-b4b4be14ea38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685F81E080>]}
[0m03:14:59.164777 [info ] [MainThread]: 
[0m03:14:59.164777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:14:59.174819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db_snapshots'
[0m03:14:59.188873 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_snapshots"
[0m03:14:59.188873 [debug] [ThreadPool]: On list_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_snapshots"} */
show objects in lab2_db.snapshots limit 10000
[0m03:14:59.188873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:00.275524 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85d43-0004-2cf5-0002-655b0001e276
[0m03:15:00.275524 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:15:00.280031 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:15:00.280031 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:15:00.280031 [debug] [ThreadPool]: On list_lab2_db_snapshots: Close
[0m03:15:00.374072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db_snapshots, now list_lab2_db_analytics)
[0m03:15:00.384083 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_analytics"
[0m03:15:00.389395 [debug] [ThreadPool]: On list_lab2_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_analytics"} */
show objects in lab2_db.analytics limit 10000
[0m03:15:00.389395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:15:01.383840 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.995 seconds
[0m03:15:01.383840 [debug] [ThreadPool]: On list_lab2_db_analytics: Close
[0m03:15:01.499815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb5777d4-b35c-4b51-9293-b4b4be14ea38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685F602380>]}
[0m03:15:01.499815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:15:01.499815 [info ] [MainThread]: 
[0m03:15:01.510662 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:15:01.510662 [info ] [Thread-1 (]: 1 of 12 START test not_null_input_stock_data_close ............................. [RUN]
[0m03:15:01.510662 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f'
[0m03:15:01.510662 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:15:01.539047 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m03:15:01.562166 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:15:01.572554 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m03:15:01.588088 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m03:15:01.588088 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from lab2_db.analytics.input_stock_data
where close is null



      
    ) dbt_internal_test
[0m03:15:01.588088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:15:02.592208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.003 seconds
[0m03:15:02.598753 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f: Close
[0m03:15:02.721647 [info ] [Thread-1 (]: 1 of 12 PASS not_null_input_stock_data_close ................................... [[32mPASS[0m in 1.21s]
[0m03:15:02.728200 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:15:02.728200 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:15:02.728200 [info ] [Thread-1 (]: 2 of 12 START test not_null_input_stock_data_date .............................. [RUN]
[0m03:15:02.728200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f, now test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817)
[0m03:15:02.728200 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:15:02.738252 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m03:15:02.752771 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:15:02.758776 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m03:15:02.768808 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m03:15:02.769201 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.input_stock_data
where date is null



      
    ) dbt_internal_test
[0m03:15:02.769201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:03.710728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.940 seconds
[0m03:15:03.711239 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817: Close
[0m03:15:03.821362 [info ] [Thread-1 (]: 2 of 12 PASS not_null_input_stock_data_date .................................... [[32mPASS[0m in 1.09s]
[0m03:15:03.821362 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:15:03.821362 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:15:03.829874 [info ] [Thread-1 (]: 3 of 12 START test not_null_input_stock_data_symbol ............................ [RUN]
[0m03:15:03.829874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817, now test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb)
[0m03:15:03.829874 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:15:03.837427 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m03:15:03.860717 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:15:03.870763 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m03:15:03.870763 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m03:15:03.880991 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.input_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m03:15:03.880991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:04.819416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.940 seconds
[0m03:15:04.819416 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb: Close
[0m03:15:04.924653 [info ] [Thread-1 (]: 3 of 12 PASS not_null_input_stock_data_symbol .................................. [[32mPASS[0m in 1.09s]
[0m03:15:04.924653 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:15:04.924653 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:15:04.924653 [info ] [Thread-1 (]: 4 of 12 START test not_null_moving_average_7d_date ............................. [RUN]
[0m03:15:04.924653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb, now test.lab2_dbt.not_null_moving_average_7d_date.6941de8714)
[0m03:15:04.924653 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:15:04.934665 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m03:15:04.956300 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:15:04.956300 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m03:15:04.966315 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m03:15:04.966315 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_date.6941de8714: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.moving_average_7d
where date is null



      
    ) dbt_internal_test
[0m03:15:04.966315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:05.944862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m03:15:05.951887 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_date.6941de8714: Close
[0m03:15:06.059605 [info ] [Thread-1 (]: 4 of 12 PASS not_null_moving_average_7d_date ................................... [[32mPASS[0m in 1.13s]
[0m03:15:06.069614 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:15:06.069614 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:15:06.069614 [info ] [Thread-1 (]: 5 of 12 START test not_null_moving_average_7d_symbol ........................... [RUN]
[0m03:15:06.069614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_moving_average_7d_date.6941de8714, now test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6)
[0m03:15:06.075173 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:15:06.079683 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m03:15:06.091289 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:15:06.101809 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m03:15:06.107324 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m03:15:06.107324 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.moving_average_7d
where symbol is null



      
    ) dbt_internal_test
[0m03:15:06.107324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:07.087233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.984 seconds
[0m03:15:07.097311 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6: Close
[0m03:15:07.203218 [info ] [Thread-1 (]: 5 of 12 PASS not_null_moving_average_7d_symbol ................................. [[32mPASS[0m in 1.13s]
[0m03:15:07.208234 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:15:07.208234 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:15:07.208234 [info ] [Thread-1 (]: 6 of 12 START test not_null_rsi_7d_date ........................................ [RUN]
[0m03:15:07.208234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6, now test.lab2_dbt.not_null_rsi_7d_date.07452c994a)
[0m03:15:07.212759 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:15:07.212759 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m03:15:07.233589 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:15:07.239116 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m03:15:07.243753 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m03:15:07.243753 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_date.07452c994a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.rsi_7d
where date is null



      
    ) dbt_internal_test
[0m03:15:07.243753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:08.242092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.997 seconds
[0m03:15:08.246601 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_date.07452c994a: Close
[0m03:15:08.345202 [info ] [Thread-1 (]: 6 of 12 PASS not_null_rsi_7d_date .............................................. [[32mPASS[0m in 1.14s]
[0m03:15:08.355258 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:15:08.356304 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:15:08.356304 [info ] [Thread-1 (]: 7 of 12 START test not_null_rsi_7d_symbol ...................................... [RUN]
[0m03:15:08.356304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_rsi_7d_date.07452c994a, now test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87)
[0m03:15:08.356304 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:15:08.365313 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m03:15:08.378039 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:15:08.385553 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m03:15:08.387594 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m03:15:08.387594 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.rsi_7d
where symbol is null



      
    ) dbt_internal_test
[0m03:15:08.395599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:09.328087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m03:15:09.331596 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87: Close
[0m03:15:09.444380 [info ] [Thread-1 (]: 7 of 12 PASS not_null_rsi_7d_symbol ............................................ [[32mPASS[0m in 1.09s]
[0m03:15:09.444380 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:15:09.444380 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909
[0m03:15:09.444380 [info ] [Thread-1 (]: 8 of 12 START test source_not_null_raw_data_stock_prices_close ................. [RUN]
[0m03:15:09.444380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87, now test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909)
[0m03:15:09.444380 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909
[0m03:15:09.453899 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909"
[0m03:15:09.458709 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909
[0m03:15:09.464717 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909"
[0m03:15:09.464717 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909"
[0m03:15:09.464717 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from lab2_db.raw_data.stock_prices
where close is null



      
    ) dbt_internal_test
[0m03:15:09.464717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:10.408635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.936 seconds
[0m03:15:10.408635 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909: Close
[0m03:15:10.542171 [info ] [Thread-1 (]: 8 of 12 PASS source_not_null_raw_data_stock_prices_close ....................... [[32mPASS[0m in 1.10s]
[0m03:15:10.543767 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909
[0m03:15:10.545825 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a
[0m03:15:10.545825 [info ] [Thread-1 (]: 9 of 12 START test source_not_null_raw_data_stock_prices_date .................. [RUN]
[0m03:15:10.545825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_data_stock_prices_close.d61ee81909, now test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a)
[0m03:15:10.545825 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a
[0m03:15:10.553832 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a"
[0m03:15:10.566117 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a
[0m03:15:10.574128 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a"
[0m03:15:10.578818 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a"
[0m03:15:10.578818 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.raw_data.stock_prices
where date is null



      
    ) dbt_internal_test
[0m03:15:10.578818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:11.550664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.969 seconds
[0m03:15:11.555672 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a: Close
[0m03:15:11.657677 [info ] [Thread-1 (]: 9 of 12 PASS source_not_null_raw_data_stock_prices_date ........................ [[32mPASS[0m in 1.11s]
[0m03:15:11.657677 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a
[0m03:15:11.657677 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80
[0m03:15:11.662204 [info ] [Thread-1 (]: 10 of 12 START test source_not_null_raw_data_stock_prices_symbol ............... [RUN]
[0m03:15:11.662204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_data_stock_prices_date.bb71048a3a, now test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80)
[0m03:15:11.662204 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80
[0m03:15:11.667711 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80"
[0m03:15:11.683534 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80
[0m03:15:11.683534 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80"
[0m03:15:11.694217 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80"
[0m03:15:11.694217 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.raw_data.stock_prices
where symbol is null



      
    ) dbt_internal_test
[0m03:15:11.694217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:12.666864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.972 seconds
[0m03:15:12.666864 [debug] [Thread-1 (]: On test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80: Close
[0m03:15:12.778444 [info ] [Thread-1 (]: 10 of 12 PASS source_not_null_raw_data_stock_prices_symbol ..................... [[32mPASS[0m in 1.12s]
[0m03:15:12.782954 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80
[0m03:15:12.782954 [debug] [Thread-1 (]: Began running node test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e
[0m03:15:12.782954 [info ] [Thread-1 (]: 11 of 12 START test source_unique_raw_data_stock_prices_symbol ................. [RUN]
[0m03:15:12.782954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_not_null_raw_data_stock_prices_symbol.089f13aa80, now test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e)
[0m03:15:12.782954 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e
[0m03:15:12.794516 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e"
[0m03:15:12.813828 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e
[0m03:15:12.813828 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e"
[0m03:15:12.823880 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e"
[0m03:15:12.826406 [debug] [Thread-1 (]: On test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from lab2_db.raw_data.stock_prices
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m03:15:12.826406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:13.764466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.939 seconds
[0m03:15:13.769494 [debug] [Thread-1 (]: On test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e: Close
[0m03:15:13.881298 [error] [Thread-1 (]: 11 of 12 FAIL 2 source_unique_raw_data_stock_prices_symbol ..................... [[31mFAIL 2[0m in 1.10s]
[0m03:15:13.881298 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e
[0m03:15:13.881298 [debug] [Thread-1 (]: Began running node test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb
[0m03:15:13.881298 [info ] [Thread-1 (]: 12 of 12 START test unique_input_stock_data_symbol ............................. [RUN]
[0m03:15:13.890820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.source_unique_raw_data_stock_prices_symbol.86f47dba7e, now test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb)
[0m03:15:13.903850 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb
[0m03:15:13.903850 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb"
[0m03:15:13.922578 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb
[0m03:15:13.927099 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb"
[0m03:15:13.932607 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb"
[0m03:15:13.932607 [debug] [Thread-1 (]: On test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    symbol as unique_field,
    count(*) as n_records

from lab2_db.analytics.input_stock_data
where symbol is not null
group by symbol
having count(*) > 1



      
    ) dbt_internal_test
[0m03:15:13.932607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:15:14.843225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.904 seconds
[0m03:15:14.843225 [debug] [Thread-1 (]: On test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb: Close
[0m03:15:14.938491 [error] [Thread-1 (]: 12 of 12 FAIL 2 unique_input_stock_data_symbol ................................. [[31mFAIL 2[0m in 1.05s]
[0m03:15:14.949277 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb
[0m03:15:14.949277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:14.949277 [debug] [MainThread]: Connection 'list_lab2_db_analytics' was properly closed.
[0m03:15:14.949277 [debug] [MainThread]: Connection 'test.lab2_dbt.unique_input_stock_data_symbol.5022bdfcbb' was properly closed.
[0m03:15:14.949277 [info ] [MainThread]: 
[0m03:15:14.949277 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 15.78 seconds (15.78s).
[0m03:15:14.959290 [debug] [MainThread]: Command end result
[0m03:15:15.050425 [info ] [MainThread]: 
[0m03:15:15.050425 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m03:15:15.050425 [info ] [MainThread]: 
[0m03:15:15.050425 [error] [MainThread]: [31mFailure in test source_unique_raw_data_stock_prices_symbol (models\input\source.yml)[0m
[0m03:15:15.050425 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:15:15.050425 [info ] [MainThread]: 
[0m03:15:15.050425 [info ] [MainThread]:   compiled code at target\compiled\lab2_dbt\models\input\source.yml\source_unique_raw_data_stock_prices_symbol.sql
[0m03:15:15.050425 [info ] [MainThread]: 
[0m03:15:15.050425 [error] [MainThread]: [31mFailure in test unique_input_stock_data_symbol (models\input\schema.yml)[0m
[0m03:15:15.060688 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m03:15:15.060688 [info ] [MainThread]: 
[0m03:15:15.060688 [info ] [MainThread]:   compiled code at target\compiled\lab2_dbt\models\input\schema.yml\unique_input_stock_data_symbol.sql
[0m03:15:15.060688 [info ] [MainThread]: 
[0m03:15:15.060688 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m03:15:15.060688 [debug] [MainThread]: Command `dbt test` failed at 03:15:15.060688 after 18.32 seconds
[0m03:15:15.060688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002683B81BDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685F63A4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002685F81F970>]}
[0m03:15:15.060688 [debug] [MainThread]: Flushing usage events
[0m03:17:10.209570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA05ADBDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA08BAFBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA08BAFF40>]}


============================== 03:17:10.214081 | ade27209-0379-451e-b5e0-2bc66bd4c916 ==============================
[0m03:17:10.214081 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:17:10.214081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:17:11.591513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ade27209-0379-451e-b5e0-2bc66bd4c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA29D82980>]}
[0m03:17:11.632090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ade27209-0379-451e-b5e0-2bc66bd4c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA08A35540>]}
[0m03:17:11.642174 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:17:11.642174 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:17:11.932691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:17:11.932691 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://models\input\source.yml
[0m03:17:11.932691 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://models\input\schema.yml
[0m03:17:12.342942 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:17:12.353035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ade27209-0379-451e-b5e0-2bc66bd4c916', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2A2AF550>]}
[0m03:17:12.596792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_dbt.example
[0m03:17:12.608838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ade27209-0379-451e-b5e0-2bc66bd4c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2A541000>]}
[0m03:17:12.831442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ade27209-0379-451e-b5e0-2bc66bd4c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2A147850>]}
[0m03:17:12.831442 [info ] [MainThread]: Found 3 models, 2 snapshots, 7 data tests, 1 source, 459 macros
[0m03:17:12.831442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade27209-0379-451e-b5e0-2bc66bd4c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2A509450>]}
[0m03:17:12.831442 [info ] [MainThread]: 
[0m03:17:12.839447 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:17:12.839447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db_analytics'
[0m03:17:12.859992 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_analytics"
[0m03:17:12.859992 [debug] [ThreadPool]: On list_lab2_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_analytics"} */
show objects in lab2_db.analytics limit 10000
[0m03:17:12.859992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:17:14.011715 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.157 seconds
[0m03:17:14.011715 [debug] [ThreadPool]: On list_lab2_db_analytics: Close
[0m03:17:14.161813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db_analytics, now list_lab2_db_snapshots)
[0m03:17:14.166662 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_snapshots"
[0m03:17:14.166662 [debug] [ThreadPool]: On list_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_snapshots"} */
show objects in lab2_db.snapshots limit 10000
[0m03:17:14.166662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:17:15.163350 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b85d45-0004-2cee-0002-655b0001bc92
[0m03:17:15.163350 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m03:17:15.163350 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m03:17:15.163350 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:17:15.163350 [debug] [ThreadPool]: On list_lab2_db_snapshots: Close
[0m03:17:15.296338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade27209-0379-451e-b5e0-2bc66bd4c916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA29D6B910>]}
[0m03:17:15.296338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:17:15.296338 [info ] [MainThread]: 
[0m03:17:15.308071 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:17:15.308071 [info ] [Thread-1 (]: 1 of 7 START test not_null_input_stock_data_close .............................. [RUN]
[0m03:17:15.308071 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f'
[0m03:17:15.308071 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:17:15.328244 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m03:17:15.354724 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:17:15.370761 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m03:17:15.380769 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m03:17:15.385804 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from lab2_db.analytics.input_stock_data
where close is null



      
    ) dbt_internal_test
[0m03:17:15.385804 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:17:16.363181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.977 seconds
[0m03:17:16.375300 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f: Close
[0m03:17:16.481936 [info ] [Thread-1 (]: 1 of 7 PASS not_null_input_stock_data_close .................................... [[32mPASS[0m in 1.17s]
[0m03:17:16.486958 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m03:17:16.486958 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:17:16.486958 [info ] [Thread-1 (]: 2 of 7 START test not_null_input_stock_data_date ............................... [RUN]
[0m03:17:16.486958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f, now test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817)
[0m03:17:16.491963 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:17:16.491963 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m03:17:16.503031 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:17:16.503031 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m03:17:16.515669 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m03:17:16.516728 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.input_stock_data
where date is null



      
    ) dbt_internal_test
[0m03:17:16.517774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:17:17.501931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.986 seconds
[0m03:17:17.506448 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817: Close
[0m03:17:17.612733 [info ] [Thread-1 (]: 2 of 7 PASS not_null_input_stock_data_date ..................................... [[32mPASS[0m in 1.13s]
[0m03:17:17.612733 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m03:17:17.612733 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:17:17.612733 [info ] [Thread-1 (]: 3 of 7 START test not_null_input_stock_data_symbol ............................. [RUN]
[0m03:17:17.612733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817, now test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb)
[0m03:17:17.612733 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:17:17.620251 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m03:17:17.640586 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:17:17.643122 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m03:17:17.650629 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m03:17:17.650629 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.input_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m03:17:17.650629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:17:18.599753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.954 seconds
[0m03:17:18.609769 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb: Close
[0m03:17:18.740904 [info ] [Thread-1 (]: 3 of 7 PASS not_null_input_stock_data_symbol ................................... [[32mPASS[0m in 1.13s]
[0m03:17:18.740904 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m03:17:18.740904 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:17:18.745422 [info ] [Thread-1 (]: 4 of 7 START test not_null_moving_average_7d_date .............................. [RUN]
[0m03:17:18.745422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb, now test.lab2_dbt.not_null_moving_average_7d_date.6941de8714)
[0m03:17:18.745422 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:17:18.745422 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m03:17:18.755472 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:17:18.755472 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m03:17:18.766060 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m03:17:18.771602 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_date.6941de8714: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.moving_average_7d
where date is null



      
    ) dbt_internal_test
[0m03:17:18.771602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:17:19.743143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.971 seconds
[0m03:17:19.743143 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_date.6941de8714: Close
[0m03:17:19.874921 [info ] [Thread-1 (]: 4 of 7 PASS not_null_moving_average_7d_date .................................... [[32mPASS[0m in 1.13s]
[0m03:17:19.875922 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m03:17:19.876922 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:17:19.876922 [info ] [Thread-1 (]: 5 of 7 START test not_null_moving_average_7d_symbol ............................ [RUN]
[0m03:17:19.878050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_moving_average_7d_date.6941de8714, now test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6)
[0m03:17:19.878050 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:17:19.878050 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m03:17:19.894639 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:17:19.894639 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m03:17:19.909686 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m03:17:19.910710 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.moving_average_7d
where symbol is null



      
    ) dbt_internal_test
[0m03:17:19.910710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:17:20.804123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.901 seconds
[0m03:17:20.815671 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6: Close
[0m03:17:20.913411 [info ] [Thread-1 (]: 5 of 7 PASS not_null_moving_average_7d_symbol .................................. [[32mPASS[0m in 1.04s]
[0m03:17:20.923493 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m03:17:20.923493 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:17:20.923493 [info ] [Thread-1 (]: 6 of 7 START test not_null_rsi_7d_date ......................................... [RUN]
[0m03:17:20.928509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6, now test.lab2_dbt.not_null_rsi_7d_date.07452c994a)
[0m03:17:20.928509 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:17:20.933516 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m03:17:20.948568 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:17:20.954578 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m03:17:20.959607 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m03:17:20.959607 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_date.07452c994a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.rsi_7d
where date is null



      
    ) dbt_internal_test
[0m03:17:20.959607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:17:21.928021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.972 seconds
[0m03:17:21.938102 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_date.07452c994a: Close
[0m03:17:22.055525 [info ] [Thread-1 (]: 6 of 7 PASS not_null_rsi_7d_date ............................................... [[32mPASS[0m in 1.13s]
[0m03:17:22.055525 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m03:17:22.055525 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:17:22.061047 [info ] [Thread-1 (]: 7 of 7 START test not_null_rsi_7d_symbol ....................................... [RUN]
[0m03:17:22.061047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_rsi_7d_date.07452c994a, now test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87)
[0m03:17:22.061047 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:17:22.071116 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m03:17:22.085983 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:17:22.091489 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m03:17:22.091489 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m03:17:22.091489 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.rsi_7d
where symbol is null



      
    ) dbt_internal_test
[0m03:17:22.091489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:17:23.071437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.976 seconds
[0m03:17:23.076475 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87: Close
[0m03:17:23.197293 [info ] [Thread-1 (]: 7 of 7 PASS not_null_rsi_7d_symbol ............................................. [[32mPASS[0m in 1.14s]
[0m03:17:23.197293 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m03:17:23.197293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:17:23.201802 [debug] [MainThread]: Connection 'list_lab2_db_snapshots' was properly closed.
[0m03:17:23.201802 [debug] [MainThread]: Connection 'test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87' was properly closed.
[0m03:17:23.201802 [info ] [MainThread]: 
[0m03:17:23.201802 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m03:17:23.201802 [debug] [MainThread]: Command end result
[0m03:17:23.356465 [info ] [MainThread]: 
[0m03:17:23.356465 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:17:23.356465 [info ] [MainThread]: 
[0m03:17:23.356465 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m03:17:23.356465 [debug] [MainThread]: Command `dbt test` succeeded at 03:17:23.356465 after 13.27 seconds
[0m03:17:23.356465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA05ADBDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA06A42050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA2A575A80>]}
[0m03:17:23.366478 [debug] [MainThread]: Flushing usage events
[0m03:18:00.715507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815D16BD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815FA03C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815FA03E20>]}


============================== 03:18:00.725671 | 794378ca-f7ec-4aba-96b1-d42ebfa07c76 ==============================
[0m03:18:00.725671 [info ] [MainThread]: Running with dbt=1.8.7
[0m03:18:00.725671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:18:02.037150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '794378ca-f7ec-4aba-96b1-d42ebfa07c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815D491420>]}
[0m03:18:02.085951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '794378ca-f7ec-4aba-96b1-d42ebfa07c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815F9D1C00>]}
[0m03:18:02.087976 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m03:18:02.096204 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m03:18:02.375111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:18:02.375111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:18:02.386179 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.lab2_dbt.example
[0m03:18:02.435819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '794378ca-f7ec-4aba-96b1-d42ebfa07c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018101051360>]}
[0m03:18:02.703689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '794378ca-f7ec-4aba-96b1-d42ebfa07c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018101053FA0>]}
[0m03:18:02.703689 [info ] [MainThread]: Found 3 models, 2 snapshots, 7 data tests, 1 source, 459 macros
[0m03:18:02.703689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '794378ca-f7ec-4aba-96b1-d42ebfa07c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018101052770>]}
[0m03:18:02.711198 [info ] [MainThread]: 
[0m03:18:02.711198 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:18:02.711198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db'
[0m03:18:02.731668 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db"
[0m03:18:02.731668 [debug] [ThreadPool]: On list_lab2_db: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db"} */
show terse schemas in database lab2_db
    limit 10000
[0m03:18:02.731668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:18:03.754848 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.021 seconds
[0m03:18:03.755858 [debug] [ThreadPool]: On list_lab2_db: Close
[0m03:18:03.857468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db, now create_lab2_db_snapshots)
[0m03:18:03.867502 [debug] [ThreadPool]: Creating schema "database: "lab2_db"
schema: "snapshots"
"
[0m03:18:03.867502 [debug] [ThreadPool]: Using snowflake connection "create_lab2_db_snapshots"
[0m03:18:03.867502 [debug] [ThreadPool]: On create_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "create_lab2_db_snapshots"} */
create schema if not exists lab2_db.snapshots
[0m03:18:03.867502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:18:04.886619 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.015 seconds
[0m03:18:04.886619 [debug] [ThreadPool]: On create_lab2_db_snapshots: Close
[0m03:18:05.064771 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db_analytics'
[0m03:18:05.070819 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_analytics"
[0m03:18:05.070819 [debug] [ThreadPool]: On list_lab2_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_analytics"} */
show objects in lab2_db.analytics limit 10000
[0m03:18:05.077350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:18:06.112051 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.039 seconds
[0m03:18:06.112051 [debug] [ThreadPool]: On list_lab2_db_analytics: Close
[0m03:18:06.245001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db_analytics, now list_lab2_db_snapshots)
[0m03:18:06.256554 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_snapshots"
[0m03:18:06.256554 [debug] [ThreadPool]: On list_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_snapshots"} */
show objects in lab2_db.snapshots limit 10000
[0m03:18:06.256554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:18:07.262755 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.006 seconds
[0m03:18:07.265845 [debug] [ThreadPool]: On list_lab2_db_snapshots: Close
[0m03:18:07.374358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '794378ca-f7ec-4aba-96b1-d42ebfa07c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815CEFF130>]}
[0m03:18:07.374358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:18:07.374358 [info ] [MainThread]: 
[0m03:18:07.389906 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m03:18:07.389906 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshots.moving_average_7d_snapshot ..................... [RUN]
[0m03:18:07.389906 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.lab2_dbt.moving_average_7d_snapshot'
[0m03:18:07.389906 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m03:18:07.394414 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m03:18:07.458136 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m03:18:07.458136 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to

    from (
        



select
    symbol,
    date as symbol_date,
    close,
    moving_average_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.moving_average_7d

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m03:18:07.458136 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:18:08.485754 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.024 seconds
[0m03:18:08.485754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m03:18:08.491600 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:18:08.569082 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.077 seconds
[0m03:18:08.571098 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m03:18:08.571098 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m03:18:08.579113 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
create or replace transient table lab2_db.snapshots.moving_average_7d_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to

    from (
        



select
    symbol,
    date as symbol_date,
    close,
    moving_average_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.moving_average_7d

    ) sbq



        );
[0m03:18:09.231031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m03:18:09.261673 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: Close
[0m03:18:09.384530 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '794378ca-f7ec-4aba-96b1-d42ebfa07c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001817FBEA770>]}
[0m03:18:09.384530 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshots.moving_average_7d_snapshot ..................... [[32mSUCCESS 1[0m in 1.99s]
[0m03:18:09.394585 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m03:18:09.394585 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.rsi_7d_snapshot
[0m03:18:09.394585 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshots.rsi_7d_snapshot ................................ [RUN]
[0m03:18:09.394585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.lab2_dbt.moving_average_7d_snapshot, now snapshot.lab2_dbt.rsi_7d_snapshot)
[0m03:18:09.399615 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.rsi_7d_snapshot
[0m03:18:09.399615 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.rsi_7d_snapshot
[0m03:18:09.408282 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m03:18:09.408817 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to

    from (
        



select
    symbol,
    date as symbol_date,
    rsi_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.rsi_7d

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m03:18:09.409341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:18:10.622911 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.217 seconds
[0m03:18:10.628432 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m03:18:10.628864 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m03:18:10.721239 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.091 seconds
[0m03:18:10.721239 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m03:18:10.736507 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m03:18:10.736507 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
create or replace transient table lab2_db.snapshots.rsi_7d_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to

    from (
        



select
    symbol,
    date as symbol_date,
    rsi_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.rsi_7d

    ) sbq



        );
[0m03:18:11.498144 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m03:18:11.498144 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: Close
[0m03:18:11.650286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '794378ca-f7ec-4aba-96b1-d42ebfa07c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001810120F6A0>]}
[0m03:18:11.650286 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshots.rsi_7d_snapshot ................................ [[32mSUCCESS 1[0m in 2.26s]
[0m03:18:11.650286 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.rsi_7d_snapshot
[0m03:18:11.660295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:18:11.660295 [debug] [MainThread]: Connection 'create_lab2_db_snapshots' was properly closed.
[0m03:18:11.660295 [debug] [MainThread]: Connection 'list_lab2_db_snapshots' was properly closed.
[0m03:18:11.660295 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.rsi_7d_snapshot' was properly closed.
[0m03:18:11.660295 [info ] [MainThread]: 
[0m03:18:11.665316 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 8.95 seconds (8.95s).
[0m03:18:11.666825 [debug] [MainThread]: Command end result
[0m03:18:11.752653 [info ] [MainThread]: 
[0m03:18:11.752653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:18:11.752653 [info ] [MainThread]: 
[0m03:18:11.752653 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:18:11.760669 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:18:11.760669 after 11.15 seconds
[0m03:18:11.761174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815D16BD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815F9D1C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001815D50F130>]}
[0m03:18:11.761174 [debug] [MainThread]: Flushing usage events
[0m05:55:21.663903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F8A7BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2FBB17B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2FBB17970>]}


============================== 05:55:21.668919 | 136c241d-51bf-42b9-9a2f-2fa71c0c8485 ==============================
[0m05:55:21.668919 [info ] [MainThread]: Running with dbt=1.8.8
[0m05:55:21.668919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:55:23.343518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F9AE1420>]}
[0m05:55:23.394268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2FFC8B730>]}
[0m05:55:23.394268 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m05:55:23.405940 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m05:55:23.583175 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m05:55:23.583175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2FB092770>]}
[0m05:55:24.991784 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m05:55:24.991784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B29D087C40>]}
[0m05:55:25.326654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B29D380220>]}
[0m05:55:25.627398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B29D42E320>]}
[0m05:55:25.627398 [info ] [MainThread]: Found 3 models, 2 snapshots, 7 data tests, 1 source, 454 macros
[0m05:55:25.630408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B29D417AF0>]}
[0m05:55:25.630408 [info ] [MainThread]: 
[0m05:55:25.630408 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:55:25.643458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db'
[0m05:55:25.650483 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db"
[0m05:55:25.650483 [debug] [ThreadPool]: On list_lab2_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db"} */
show terse schemas in database lab2_db
    limit 10000
[0m05:55:25.650483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:26.796991 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.142 seconds
[0m05:55:26.800013 [debug] [ThreadPool]: On list_lab2_db: Close
[0m05:55:26.929628 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db_analytics'
[0m05:55:26.944199 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_analytics"
[0m05:55:26.944199 [debug] [ThreadPool]: On list_lab2_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_analytics"} */
show objects in lab2_db.analytics limit 10000
[0m05:55:26.944199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:27.981816 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.034 seconds
[0m05:55:27.981816 [debug] [ThreadPool]: On list_lab2_db_analytics: Close
[0m05:55:28.083952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db_analytics, now list_lab2_db_snapshots)
[0m05:55:28.091110 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_snapshots"
[0m05:55:28.091110 [debug] [ThreadPool]: On list_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_snapshots"} */
show objects in lab2_db.snapshots limit 10000
[0m05:55:28.094139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:55:29.034021 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.949 seconds
[0m05:55:29.046173 [debug] [ThreadPool]: On list_lab2_db_snapshots: Close
[0m05:55:29.235424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B29D383B80>]}
[0m05:55:29.235424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:55:29.235424 [info ] [MainThread]: 
[0m05:55:29.255995 [debug] [Thread-1 (]: Began running node model.lab2_dbt.input_stock_data
[0m05:55:29.255995 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.input_stock_data ......................... [RUN]
[0m05:55:29.255995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab2_dbt.input_stock_data'
[0m05:55:29.255995 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.input_stock_data
[0m05:55:29.266173 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.input_stock_data"
[0m05:55:29.276179 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.input_stock_data
[0m05:55:29.299135 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.input_stock_data"
[0m05:55:29.306653 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.input_stock_data"
[0m05:55:29.306653 [debug] [Thread-1 (]: On model.lab2_dbt.input_stock_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.input_stock_data"} */
create or replace   view lab2_db.analytics.input_stock_data
  
   as (
    select * from lab2_db.raw_data.stock_prices
  );
[0m05:55:29.306653 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m05:55:31.080960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.783 seconds
[0m05:55:31.112633 [debug] [Thread-1 (]: On model.lab2_dbt.input_stock_data: Close
[0m05:55:31.219505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2FB093F70>]}
[0m05:55:31.219505 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.input_stock_data .................... [[32mSUCCESS 1[0m in 1.96s]
[0m05:55:31.222036 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.input_stock_data
[0m05:55:31.222036 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average_7d
[0m05:55:31.222036 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.moving_average_7d ........................ [RUN]
[0m05:55:31.222036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.input_stock_data, now model.lab2_dbt.moving_average_7d)
[0m05:55:31.222036 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average_7d
[0m05:55:31.229543 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average_7d"
[0m05:55:31.242106 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.moving_average_7d
[0m05:55:31.250635 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.moving_average_7d"
[0m05:55:31.260681 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.moving_average_7d"
[0m05:55:31.260681 [debug] [Thread-1 (]: On model.lab2_dbt.moving_average_7d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.moving_average_7d"} */
create or replace   view lab2_db.analytics.moving_average_7d
  
   as (
    select
    symbol,
    date,
    close,
    avg(close) over (
        partition by symbol
        order by date
        rows between 6 preceding and current row
    ) as moving_average_7d
from lab2_db.analytics.input_stock_data
  );
[0m05:55:31.260681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:32.653918 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.393 seconds
[0m05:55:32.659940 [debug] [Thread-1 (]: On model.lab2_dbt.moving_average_7d: Close
[0m05:55:32.834939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B29D04F2B0>]}
[0m05:55:32.834939 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.moving_average_7d ................... [[32mSUCCESS 1[0m in 1.61s]
[0m05:55:32.842451 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average_7d
[0m05:55:32.842451 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi_7d
[0m05:55:32.842451 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi_7d ................................... [RUN]
[0m05:55:32.842451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average_7d, now model.lab2_dbt.rsi_7d)
[0m05:55:32.842451 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi_7d
[0m05:55:32.842451 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi_7d"
[0m05:55:32.872811 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.rsi_7d
[0m05:55:32.872811 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.rsi_7d"
[0m05:55:32.882862 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.rsi_7d"
[0m05:55:32.882862 [debug] [Thread-1 (]: On model.lab2_dbt.rsi_7d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.rsi_7d"} */
create or replace   view lab2_db.analytics.rsi_7d
  
   as (
    with price_changes as (
    select
        symbol,
        date,
        close,
        lag(close) over (partition by symbol order by date) as previous_close,
        case
            when close > lag(close) over (partition by symbol order by date) then close - lag(close) over (partition by symbol order by date)
            else 0
        end as gain,
        case
            when close < lag(close) over (partition by symbol order by date) then lag(close) over (partition by symbol order by date) - close
            else 0
        end as loss
    from lab2_db.analytics.input_stock_data
),
avg_gains_losses as (
    select
        symbol,
        date,
        avg(gain) over (
            partition by symbol
            order by date
            rows between 6 preceding and current row
        ) as avg_gain,
        avg(loss) over (
            partition by symbol
            order by date
            rows between 6 preceding and current row
        ) as avg_loss
    from price_changes
)
select
    symbol,
    date,
    100 - (100 / (1 + (avg_gain / nullif(avg_loss, 0)))) as rsi_7d
from avg_gains_losses
  );
[0m05:55:32.882862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:34.304575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.413 seconds
[0m05:55:34.304575 [debug] [Thread-1 (]: On model.lab2_dbt.rsi_7d: Close
[0m05:55:34.425008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136c241d-51bf-42b9-9a2f-2fa71c0c8485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2FFF42260>]}
[0m05:55:34.425008 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi_7d .............................. [[32mSUCCESS 1[0m in 1.58s]
[0m05:55:34.425008 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi_7d
[0m05:55:34.425008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:34.425008 [debug] [MainThread]: Connection 'list_lab2_db' was properly closed.
[0m05:55:34.425008 [debug] [MainThread]: Connection 'list_lab2_db_snapshots' was properly closed.
[0m05:55:34.425008 [debug] [MainThread]: Connection 'model.lab2_dbt.rsi_7d' was properly closed.
[0m05:55:34.425008 [info ] [MainThread]: 
[0m05:55:34.435015 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m05:55:34.435015 [debug] [MainThread]: Command end result
[0m05:55:34.534405 [info ] [MainThread]: 
[0m05:55:34.538910 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:55:34.538910 [info ] [MainThread]: 
[0m05:55:34.538910 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m05:55:34.538910 [debug] [MainThread]: Command `dbt run` succeeded at 05:55:34.538910 after 13.04 seconds
[0m05:55:34.538910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F8A7BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2FB80FE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F960DFC0>]}
[0m05:55:34.538910 [debug] [MainThread]: Flushing usage events
[0m05:59:03.860626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002634DA2BD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026350B0BB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026350B0B970>]}


============================== 05:59:03.860626 | 77677160-7921-4506-a0af-194a209a05a0 ==============================
[0m05:59:03.860626 [info ] [MainThread]: Running with dbt=1.8.8
[0m05:59:03.860626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:59:05.284116 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('partial_parse' was unexpected)

Error encountered in D:\study\SJSU\SEM_1\Data_Warehouse-data_226\Lab2\airflow\lab2_dbt\dbt_project.yml
[0m05:59:05.284116 [debug] [MainThread]: Command `dbt run` failed at 05:59:05.284116 after 1.57 seconds
[0m05:59:05.284116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002634DA2BD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026350B08700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026371D07DC0>]}
[0m05:59:05.284116 [debug] [MainThread]: Flushing usage events
[0m05:59:35.436900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178608BBD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017863997B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017863997970>]}


============================== 05:59:35.443485 | c0032885-08f4-4e33-bdcb-30a8c10c7991 ==============================
[0m05:59:35.443485 [info ] [MainThread]: Running with dbt=1.8.8
[0m05:59:35.443485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:59:36.685324 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('partial_parse' was unexpected)

Error encountered in D:\study\SJSU\SEM_1\Data_Warehouse-data_226\Lab2\airflow\lab2_dbt\dbt_project.yml
[0m05:59:36.685324 [debug] [MainThread]: Command `dbt run` failed at 05:59:36.685324 after 1.37 seconds
[0m05:59:36.691471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178608BBD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786395CD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017804B97A30>]}
[0m05:59:36.691471 [debug] [MainThread]: Flushing usage events
[0m06:00:00.382072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4F78BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD52827BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD528279D0>]}


============================== 06:00:00.387580 | b9749ad0-3c19-4000-accf-84a6cde81769 ==============================
[0m06:00:00.387580 [info ] [MainThread]: Running with dbt=1.8.8
[0m06:00:00.387580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:00:01.795235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9749ad0-3c19-4000-accf-84a6cde81769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD502B14B0>]}
[0m06:00:01.852188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9749ad0-3c19-4000-accf-84a6cde81769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD739F7730>]}
[0m06:00:01.857721 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:00:01.867321 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m06:00:02.161079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m06:00:02.167606 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://models\input\schema.yml
[0m06:00:02.167606 [debug] [MainThread]: Partial parsing: updated file: lab2_dbt://models\output\schema.yml
[0m06:00:02.707361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9749ad0-3c19-4000-accf-84a6cde81769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD73E33220>]}
[0m06:00:02.935342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9749ad0-3c19-4000-accf-84a6cde81769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD73F60E50>]}
[0m06:00:02.935342 [info ] [MainThread]: Found 2 snapshots, 3 models, 7 data tests, 1 source, 454 macros
[0m06:00:02.935342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9749ad0-3c19-4000-accf-84a6cde81769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD73F50280>]}
[0m06:00:02.935342 [info ] [MainThread]: 
[0m06:00:02.945372 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:00:02.950461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db'
[0m06:00:02.966627 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db"
[0m06:00:02.966627 [debug] [ThreadPool]: On list_lab2_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db"} */
show terse schemas in database lab2_db
    limit 10000
[0m06:00:02.968641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:04.129182 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.164 seconds
[0m06:00:04.129182 [debug] [ThreadPool]: On list_lab2_db: Close
[0m06:00:04.247434 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db_snapshots'
[0m06:00:04.259999 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_snapshots"
[0m06:00:04.259999 [debug] [ThreadPool]: On list_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_snapshots"} */
show objects in lab2_db.snapshots limit 10000
[0m06:00:04.259999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:05.326064 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.066 seconds
[0m06:00:05.326064 [debug] [ThreadPool]: On list_lab2_db_snapshots: Close
[0m06:00:05.437534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db_snapshots, now list_lab2_db_analytics)
[0m06:00:05.437534 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_analytics"
[0m06:00:05.447548 [debug] [ThreadPool]: On list_lab2_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_analytics"} */
show objects in lab2_db.analytics limit 10000
[0m06:00:05.447548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:06.542109 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.093 seconds
[0m06:00:06.544390 [debug] [ThreadPool]: On list_lab2_db_analytics: Close
[0m06:00:06.656377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9749ad0-3c19-4000-accf-84a6cde81769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4F51F4C0>]}
[0m06:00:06.656377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:00:06.656377 [info ] [MainThread]: 
[0m06:00:06.666414 [debug] [Thread-1 (]: Began running node model.lab2_dbt.input_stock_data
[0m06:00:06.666414 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.input_stock_data ......................... [RUN]
[0m06:00:06.670931 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.lab2_dbt.input_stock_data'
[0m06:00:06.670931 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.input_stock_data
[0m06:00:06.676449 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.input_stock_data"
[0m06:00:06.692038 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.input_stock_data
[0m06:00:06.718004 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.input_stock_data"
[0m06:00:06.733193 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.input_stock_data"
[0m06:00:06.743201 [debug] [Thread-1 (]: On model.lab2_dbt.input_stock_data: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.input_stock_data"} */
create or replace   view lab2_db.analytics.input_stock_data
  
   as (
    select * from lab2_db.raw_data.stock_prices
  );
[0m06:00:06.743201 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:00:08.011074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.273 seconds
[0m06:00:08.034237 [debug] [Thread-1 (]: On model.lab2_dbt.input_stock_data: Close
[0m06:00:08.143689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9749ad0-3c19-4000-accf-84a6cde81769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD739AA2F0>]}
[0m06:00:08.146197 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.input_stock_data .................... [[32mSUCCESS 1[0m in 1.46s]
[0m06:00:08.146197 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.input_stock_data
[0m06:00:08.146197 [debug] [Thread-1 (]: Began running node model.lab2_dbt.moving_average_7d
[0m06:00:08.153703 [info ] [Thread-1 (]: 2 of 3 START sql view model analytics.moving_average_7d ........................ [RUN]
[0m06:00:08.153703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.input_stock_data, now model.lab2_dbt.moving_average_7d)
[0m06:00:08.153703 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.moving_average_7d
[0m06:00:08.153703 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.moving_average_7d"
[0m06:00:08.163734 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.moving_average_7d
[0m06:00:08.163734 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.moving_average_7d"
[0m06:00:08.173804 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.moving_average_7d"
[0m06:00:08.173804 [debug] [Thread-1 (]: On model.lab2_dbt.moving_average_7d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.moving_average_7d"} */
create or replace   view lab2_db.analytics.moving_average_7d
  
   as (
    select
    symbol,
    date,
    close,
    avg(close) over (
        partition by symbol
        order by date
        rows between 6 preceding and current row
    ) as moving_average_7d
from lab2_db.analytics.input_stock_data
  );
[0m06:00:08.173804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:09.276096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.100 seconds
[0m06:00:09.279110 [debug] [Thread-1 (]: On model.lab2_dbt.moving_average_7d: Close
[0m06:00:09.367969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9749ad0-3c19-4000-accf-84a6cde81769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD74208DC0>]}
[0m06:00:09.368991 [info ] [Thread-1 (]: 2 of 3 OK created sql view model analytics.moving_average_7d ................... [[32mSUCCESS 1[0m in 1.21s]
[0m06:00:09.370013 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.moving_average_7d
[0m06:00:09.371040 [debug] [Thread-1 (]: Began running node model.lab2_dbt.rsi_7d
[0m06:00:09.372068 [info ] [Thread-1 (]: 3 of 3 START sql view model analytics.rsi_7d ................................... [RUN]
[0m06:00:09.373094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.lab2_dbt.moving_average_7d, now model.lab2_dbt.rsi_7d)
[0m06:00:09.374117 [debug] [Thread-1 (]: Began compiling node model.lab2_dbt.rsi_7d
[0m06:00:09.379148 [debug] [Thread-1 (]: Writing injected SQL for node "model.lab2_dbt.rsi_7d"
[0m06:00:09.388830 [debug] [Thread-1 (]: Began executing node model.lab2_dbt.rsi_7d
[0m06:00:09.388830 [debug] [Thread-1 (]: Writing runtime sql for node "model.lab2_dbt.rsi_7d"
[0m06:00:09.403842 [debug] [Thread-1 (]: Using snowflake connection "model.lab2_dbt.rsi_7d"
[0m06:00:09.404963 [debug] [Thread-1 (]: On model.lab2_dbt.rsi_7d: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "model.lab2_dbt.rsi_7d"} */
create or replace   view lab2_db.analytics.rsi_7d
  
   as (
    with price_changes as (
    select
        symbol,
        date,
        close,
        lag(close) over (partition by symbol order by date) as previous_close,
        case
            when close > lag(close) over (partition by symbol order by date) then close - lag(close) over (partition by symbol order by date)
            else 0
        end as gain,
        case
            when close < lag(close) over (partition by symbol order by date) then lag(close) over (partition by symbol order by date) - close
            else 0
        end as loss
    from lab2_db.analytics.input_stock_data
),
avg_gains_losses as (
    select
        symbol,
        date,
        avg(gain) over (
            partition by symbol
            order by date
            rows between 6 preceding and current row
        ) as avg_gain,
        avg(loss) over (
            partition by symbol
            order by date
            rows between 6 preceding and current row
        ) as avg_loss
    from price_changes
)
select
    symbol,
    date,
    100 - (100 / (1 + (avg_gain / nullif(avg_loss, 0)))) as rsi_7d
from avg_gains_losses
  );
[0m06:00:09.404963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:10.744261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.340 seconds
[0m06:00:10.744261 [debug] [Thread-1 (]: On model.lab2_dbt.rsi_7d: Close
[0m06:00:10.856491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9749ad0-3c19-4000-accf-84a6cde81769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD73C64AF0>]}
[0m06:00:10.856491 [info ] [Thread-1 (]: 3 of 3 OK created sql view model analytics.rsi_7d .............................. [[32mSUCCESS 1[0m in 1.48s]
[0m06:00:10.867013 [debug] [Thread-1 (]: Finished running node model.lab2_dbt.rsi_7d
[0m06:00:10.867013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:10.867013 [debug] [MainThread]: Connection 'list_lab2_db' was properly closed.
[0m06:00:10.867013 [debug] [MainThread]: Connection 'list_lab2_db_analytics' was properly closed.
[0m06:00:10.867013 [debug] [MainThread]: Connection 'model.lab2_dbt.rsi_7d' was properly closed.
[0m06:00:10.867013 [info ] [MainThread]: 
[0m06:00:10.867013 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.92 seconds (7.92s).
[0m06:00:10.877021 [debug] [MainThread]: Command end result
[0m06:00:10.948279 [info ] [MainThread]: 
[0m06:00:10.948279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:00:10.948279 [info ] [MainThread]: 
[0m06:00:10.948279 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:00:10.958308 [debug] [MainThread]: Command `dbt run` succeeded at 06:00:10.958308 after 10.69 seconds
[0m06:00:10.958308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4F78BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD526A0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD739F7730>]}
[0m06:00:10.958308 [debug] [MainThread]: Flushing usage events
[0m06:01:13.316206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001735E81BD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173618B7B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173618B7940>]}


============================== 06:01:13.316206 | a1b2fea9-34ba-4b9a-92f2-76fca1d2b29d ==============================
[0m06:01:13.316206 [info ] [MainThread]: Running with dbt=1.8.8
[0m06:01:13.316206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:01:14.869781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1b2fea9-34ba-4b9a-92f2-76fca1d2b29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001735F3413C0>]}
[0m06:01:14.920053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1b2fea9-34ba-4b9a-92f2-76fca1d2b29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017302AAB730>]}
[0m06:01:14.930492 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:01:14.940605 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m06:01:15.260068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:01:15.260068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:01:15.321238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1b2fea9-34ba-4b9a-92f2-76fca1d2b29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017302E7BDF0>]}
[0m06:01:15.638419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1b2fea9-34ba-4b9a-92f2-76fca1d2b29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017302E4B190>]}
[0m06:01:15.638419 [info ] [MainThread]: Found 2 snapshots, 3 models, 7 data tests, 1 source, 454 macros
[0m06:01:15.638419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1b2fea9-34ba-4b9a-92f2-76fca1d2b29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017302D93CD0>]}
[0m06:01:15.638419 [info ] [MainThread]: 
[0m06:01:15.638419 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:01:15.652562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db_analytics'
[0m06:01:15.668649 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_analytics"
[0m06:01:15.668649 [debug] [ThreadPool]: On list_lab2_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_analytics"} */
show objects in lab2_db.analytics limit 10000
[0m06:01:15.668649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:01:16.783354 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.113 seconds
[0m06:01:16.787358 [debug] [ThreadPool]: On list_lab2_db_analytics: Close
[0m06:01:16.892869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db_analytics, now list_lab2_db_snapshots)
[0m06:01:16.894337 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_snapshots"
[0m06:01:16.894337 [debug] [ThreadPool]: On list_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_snapshots"} */
show objects in lab2_db.snapshots limit 10000
[0m06:01:16.894337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:01:17.985527 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.085 seconds
[0m06:01:17.989726 [debug] [ThreadPool]: On list_lab2_db_snapshots: Close
[0m06:01:18.107974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1b2fea9-34ba-4b9a-92f2-76fca1d2b29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017302E48280>]}
[0m06:01:18.107974 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:01:18.107974 [info ] [MainThread]: 
[0m06:01:18.117992 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m06:01:18.117992 [info ] [Thread-1 (]: 1 of 7 START test not_null_input_stock_data_close .............................. [RUN]
[0m06:01:18.117992 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f'
[0m06:01:18.117992 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m06:01:18.134266 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m06:01:18.154326 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m06:01:18.174394 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m06:01:18.184519 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"
[0m06:01:18.184519 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select close
from lab2_db.analytics.input_stock_data
where close is null



      
    ) dbt_internal_test
[0m06:01:18.184519 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:01:19.662198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.477 seconds
[0m06:01:19.681938 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f: Close
[0m06:01:19.800906 [info ] [Thread-1 (]: 1 of 7 PASS not_null_input_stock_data_close .................................... [[32mPASS[0m in 1.68s]
[0m06:01:19.803126 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f
[0m06:01:19.803634 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m06:01:19.805610 [info ] [Thread-1 (]: 2 of 7 START test not_null_input_stock_data_date ............................... [RUN]
[0m06:01:19.806199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_close.411ae5db1f, now test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817)
[0m06:01:19.806199 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m06:01:19.810680 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m06:01:19.822929 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m06:01:19.827806 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m06:01:19.837426 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"
[0m06:01:19.837426 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.input_stock_data
where date is null



      
    ) dbt_internal_test
[0m06:01:19.837426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:21.144234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.304 seconds
[0m06:01:21.147022 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817: Close
[0m06:01:21.278422 [info ] [Thread-1 (]: 2 of 7 PASS not_null_input_stock_data_date ..................................... [[32mPASS[0m in 1.47s]
[0m06:01:21.278422 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817
[0m06:01:21.278422 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m06:01:21.278422 [info ] [Thread-1 (]: 3 of 7 START test not_null_input_stock_data_symbol ............................. [RUN]
[0m06:01:21.278422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_date.f8f33f5817, now test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb)
[0m06:01:21.278422 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m06:01:21.288436 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m06:01:21.300923 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m06:01:21.308943 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m06:01:21.308943 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"
[0m06:01:21.318964 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.input_stock_data
where symbol is null



      
    ) dbt_internal_test
[0m06:01:21.318964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:22.564430 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.245 seconds
[0m06:01:22.564942 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb: Close
[0m06:01:22.687700 [info ] [Thread-1 (]: 3 of 7 PASS not_null_input_stock_data_symbol ................................... [[32mPASS[0m in 1.41s]
[0m06:01:22.689478 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb
[0m06:01:22.692017 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m06:01:22.693389 [info ] [Thread-1 (]: 4 of 7 START test not_null_moving_average_7d_date .............................. [RUN]
[0m06:01:22.695261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_input_stock_data_symbol.37d2f8c8cb, now test.lab2_dbt.not_null_moving_average_7d_date.6941de8714)
[0m06:01:22.696293 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m06:01:22.702851 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m06:01:22.713494 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m06:01:22.713494 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m06:01:22.723814 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"
[0m06:01:22.723814 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_date.6941de8714: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_moving_average_7d_date.6941de8714"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.moving_average_7d
where date is null



      
    ) dbt_internal_test
[0m06:01:22.723814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:24.085143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.357 seconds
[0m06:01:24.089161 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_date.6941de8714: Close
[0m06:01:24.220882 [info ] [Thread-1 (]: 4 of 7 PASS not_null_moving_average_7d_date .................................... [[32mPASS[0m in 1.53s]
[0m06:01:24.220882 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_moving_average_7d_date.6941de8714
[0m06:01:24.220882 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m06:01:24.220882 [info ] [Thread-1 (]: 5 of 7 START test not_null_moving_average_7d_symbol ............................ [RUN]
[0m06:01:24.220882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_moving_average_7d_date.6941de8714, now test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6)
[0m06:01:24.220882 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m06:01:24.232418 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m06:01:24.261643 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m06:01:24.264158 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m06:01:24.271971 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"
[0m06:01:24.271971 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.moving_average_7d
where symbol is null



      
    ) dbt_internal_test
[0m06:01:24.271971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:25.551476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.279 seconds
[0m06:01:25.555987 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6: Close
[0m06:01:25.669902 [info ] [Thread-1 (]: 5 of 7 PASS not_null_moving_average_7d_symbol .................................. [[32mPASS[0m in 1.45s]
[0m06:01:25.669902 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6
[0m06:01:25.673421 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m06:01:25.673421 [info ] [Thread-1 (]: 6 of 7 START test not_null_rsi_7d_date ......................................... [RUN]
[0m06:01:25.673421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_moving_average_7d_symbol.9824f70bf6, now test.lab2_dbt.not_null_rsi_7d_date.07452c994a)
[0m06:01:25.673421 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m06:01:25.683471 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m06:01:25.683471 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m06:01:25.693515 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m06:01:25.695046 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"
[0m06:01:25.695046 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_date.07452c994a: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_rsi_7d_date.07452c994a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from lab2_db.analytics.rsi_7d
where date is null



      
    ) dbt_internal_test
[0m06:01:25.695046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:26.670376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.969 seconds
[0m06:01:26.674751 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_date.07452c994a: Close
[0m06:01:26.779977 [info ] [Thread-1 (]: 6 of 7 PASS not_null_rsi_7d_date ............................................... [[32mPASS[0m in 1.11s]
[0m06:01:26.782986 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_rsi_7d_date.07452c994a
[0m06:01:26.782986 [debug] [Thread-1 (]: Began running node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m06:01:26.782986 [info ] [Thread-1 (]: 7 of 7 START test not_null_rsi_7d_symbol ....................................... [RUN]
[0m06:01:26.782986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.lab2_dbt.not_null_rsi_7d_date.07452c994a, now test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87)
[0m06:01:26.782986 [debug] [Thread-1 (]: Began compiling node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m06:01:26.793027 [debug] [Thread-1 (]: Writing injected SQL for node "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m06:01:26.828092 [debug] [Thread-1 (]: Began executing node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m06:01:26.834115 [debug] [Thread-1 (]: Writing runtime sql for node "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m06:01:26.843154 [debug] [Thread-1 (]: Using snowflake connection "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"
[0m06:01:26.844158 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select symbol
from lab2_db.analytics.rsi_7d
where symbol is null



      
    ) dbt_internal_test
[0m06:01:26.844158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:27.778655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.936 seconds
[0m06:01:27.782671 [debug] [Thread-1 (]: On test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87: Close
[0m06:01:27.894247 [info ] [Thread-1 (]: 7 of 7 PASS not_null_rsi_7d_symbol ............................................. [[32mPASS[0m in 1.11s]
[0m06:01:27.894247 [debug] [Thread-1 (]: Finished running node test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87
[0m06:01:27.894247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:01:27.894247 [debug] [MainThread]: Connection 'list_lab2_db_snapshots' was properly closed.
[0m06:01:27.894247 [debug] [MainThread]: Connection 'test.lab2_dbt.not_null_rsi_7d_symbol.0d7e37fd87' was properly closed.
[0m06:01:27.894247 [info ] [MainThread]: 
[0m06:01:27.894247 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 12.26 seconds (12.26s).
[0m06:01:27.904282 [debug] [MainThread]: Command end result
[0m06:01:27.989745 [info ] [MainThread]: 
[0m06:01:27.989745 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:01:27.989745 [info ] [MainThread]: 
[0m06:01:27.989745 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m06:01:27.995754 [debug] [MainThread]: Command `dbt test` succeeded at 06:01:27.995754 after 14.83 seconds
[0m06:01:27.995754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001735E81BD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001735E4A39D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173033029B0>]}
[0m06:01:27.995754 [debug] [MainThread]: Flushing usage events
[0m06:01:59.875139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7C91BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7F9EFB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7F9EF970>]}


============================== 06:01:59.875139 | ebb9733b-111e-4b0f-b94e-5a74c764ada4 ==============================
[0m06:01:59.875139 [info ] [MainThread]: Running with dbt=1.8.8
[0m06:01:59.875139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'debug': 'False', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:02:01.210481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebb9733b-111e-4b0f-b94e-5a74c764ada4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7D9A1420>]}
[0m06:02:01.260904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebb9733b-111e-4b0f-b94e-5a74c764ada4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A20BF7730>]}
[0m06:02:01.260904 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:02:01.270949 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m06:02:01.549739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:02:01.549739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:02:01.610434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebb9733b-111e-4b0f-b94e-5a74c764ada4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A20FB7E50>]}
[0m06:02:01.885152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebb9733b-111e-4b0f-b94e-5a74c764ada4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A20F62410>]}
[0m06:02:01.885152 [info ] [MainThread]: Found 2 snapshots, 3 models, 7 data tests, 1 source, 454 macros
[0m06:02:01.885152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb9733b-111e-4b0f-b94e-5a74c764ada4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7F6EFE80>]}
[0m06:02:01.885152 [info ] [MainThread]: 
[0m06:02:01.885152 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:02:01.895198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db'
[0m06:02:01.908254 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db"
[0m06:02:01.908254 [debug] [ThreadPool]: On list_lab2_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db"} */
show terse schemas in database lab2_db
    limit 10000
[0m06:02:01.908254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:03.110203 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.198 seconds
[0m06:02:03.110203 [debug] [ThreadPool]: On list_lab2_db: Close
[0m06:02:03.210597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db_analytics'
[0m06:02:03.222634 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_analytics"
[0m06:02:03.222634 [debug] [ThreadPool]: On list_lab2_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_analytics"} */
show objects in lab2_db.analytics limit 10000
[0m06:02:03.222634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:02:04.304793 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.080 seconds
[0m06:02:04.304793 [debug] [ThreadPool]: On list_lab2_db_analytics: Close
[0m06:02:04.418984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db_analytics, now list_lab2_db_snapshots)
[0m06:02:04.418984 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_snapshots"
[0m06:02:04.418984 [debug] [ThreadPool]: On list_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_snapshots"} */
show objects in lab2_db.snapshots limit 10000
[0m06:02:04.429007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:02:05.507504 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.081 seconds
[0m06:02:05.512010 [debug] [ThreadPool]: On list_lab2_db_snapshots: Close
[0m06:02:05.640228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb9733b-111e-4b0f-b94e-5a74c764ada4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7C6AFEB0>]}
[0m06:02:05.640228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:02:05.642238 [info ] [MainThread]: 
[0m06:02:05.644255 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m06:02:05.644255 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshots.moving_average_7d_snapshot ..................... [RUN]
[0m06:02:05.644255 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.lab2_dbt.moving_average_7d_snapshot'
[0m06:02:05.644255 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m06:02:05.655333 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m06:02:05.719024 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:05.719024 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT"
[0m06:02:05.719024 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:02:06.783040 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 1.062 seconds
[0m06:02:06.803426 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:06.813442 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
create or replace temporary table "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    symbol,
    date as symbol_date,
    close,
    moving_average_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.moving_average_7d


    ),

    snapshotted_data as (

        select *,
            symbol_date as dbt_unique_key

        from "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol_date as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol_date as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m06:02:07.879541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.065 seconds
[0m06:02:07.884088 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:07.884088 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT__dbt_tmp"
[0m06:02:07.977871 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.099 seconds
[0m06:02:07.987880 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:07.987880 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT"
[0m06:02:08.080253 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.090 seconds
[0m06:02:08.090304 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:08.090304 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT__dbt_tmp"
[0m06:02:08.188417 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.095 seconds
[0m06:02:08.188417 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:08.188417 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT"
[0m06:02:08.313840 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.120 seconds
[0m06:02:08.321353 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:08.321353 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT__dbt_tmp"
[0m06:02:08.435348 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.106 seconds
[0m06:02:08.460504 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:08.462106 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    symbol,
    date as symbol_date,
    close,
    moving_average_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.moving_average_7d


    ),

    snapshotted_data as (

        select *,
            symbol_date as dbt_unique_key

        from "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol_date as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol_date as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m06:02:08.692883 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.219 seconds
[0m06:02:08.695953 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:08.695953 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m06:02:08.779010 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.079 seconds
[0m06:02:08.779010 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:08.799280 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:08.806432 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
BEGIN
[0m06:02:08.902475 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m06:02:08.912485 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:02:08.912485 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
merge into "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT" as DBT_INTERNAL_DEST
    using "LAB2_DB"."SNAPSHOTS"."MOVING_AVERAGE_7D_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "SYMBOL_DATE", "CLOSE", "MOVING_AVERAGE_7D", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "SYMBOL_DATE", "CLOSE", "MOVING_AVERAGE_7D", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:02:09.568603 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85dea-0004-2cf5-0002-655b0001e6a6
[0m06:02:09.568603 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m06:02:09.570408 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: Close
[0m06:02:09.672852 [debug] [Thread-1 (]: Database Error in snapshot moving_average_7d_snapshot (snapshots\moving_average_7d_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target\run\lab2_dbt\snapshots\moving_average_7d_snapshot.sql
[0m06:02:09.672852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb9733b-111e-4b0f-b94e-5a74c764ada4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A2123E9E0>]}
[0m06:02:09.672852 [error] [Thread-1 (]: 1 of 2 ERROR snapshotting snapshots.moving_average_7d_snapshot ................. [[31mERROR[0m in 4.03s]
[0m06:02:09.681949 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m06:02:09.681949 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.rsi_7d_snapshot
[0m06:02:09.681949 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshots.rsi_7d_snapshot ................................ [RUN]
[0m06:02:09.681949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.lab2_dbt.moving_average_7d_snapshot, now snapshot.lab2_dbt.rsi_7d_snapshot)
[0m06:02:09.681949 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.rsi_7d_snapshot
[0m06:02:09.681949 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.rsi_7d_snapshot
[0m06:02:09.691954 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:09.691954 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT"
[0m06:02:09.691954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:02:10.751466 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 1.056 seconds
[0m06:02:10.756766 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:10.756766 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
create or replace temporary table "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT__dbt_tmp"
         as
        (

    with snapshot_query as (

        



select
    symbol,
    date as symbol_date,
    rsi_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.rsi_7d


    ),

    snapshotted_data as (

        select *,
            symbol_date as dbt_unique_key

        from "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol_date as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol_date as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

        );
[0m06:02:11.851683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.090 seconds
[0m06:02:11.854859 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:11.854859 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT__dbt_tmp"
[0m06:02:11.932429 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.078 seconds
[0m06:02:11.937514 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:11.937514 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT"
[0m06:02:12.027795 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.090 seconds
[0m06:02:12.033708 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:12.033708 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT__dbt_tmp"
[0m06:02:12.109439 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.071 seconds
[0m06:02:12.115754 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:12.116807 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT"
[0m06:02:12.193393 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.077 seconds
[0m06:02:12.193393 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:12.203131 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
describe table "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT__dbt_tmp"
[0m06:02:12.283347 [debug] [Thread-1 (]: SQL status: SUCCESS 10 in 0.083 seconds
[0m06:02:12.290171 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:12.290171 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
select * from (
        

    with snapshot_query as (

        



select
    symbol,
    date as symbol_date,
    rsi_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.rsi_7d


    ),

    snapshotted_data as (

        select *,
            symbol_date as dbt_unique_key

        from "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            symbol_date as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            symbol_date as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
[0m06:02:12.549069 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.253 seconds
[0m06:02:12.551118 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:12.552138 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m06:02:12.625981 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m06:02:12.626524 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:12.639445 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:12.641164 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
BEGIN
[0m06:02:12.759260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m06:02:12.762772 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:02:12.762772 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
merge into "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT" as DBT_INTERNAL_DEST
    using "LAB2_DB"."SNAPSHOTS"."RSI_7D_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "SYMBOL_DATE", "RSI_7D", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "SYMBOL_DATE", "RSI_7D", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m06:02:13.219073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b85dea-0004-2ced-0002-655b0001c826
[0m06:02:13.219073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m06:02:13.219073 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: Close
[0m06:02:13.321629 [debug] [Thread-1 (]: Database Error in snapshot rsi_7d_snapshot (snapshots\rsi_7d_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target\run\lab2_dbt\snapshots\rsi_7d_snapshot.sql
[0m06:02:13.321629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb9733b-111e-4b0f-b94e-5a74c764ada4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A21402470>]}
[0m06:02:13.321629 [error] [Thread-1 (]: 2 of 2 ERROR snapshotting snapshots.rsi_7d_snapshot ............................ [[31mERROR[0m in 3.64s]
[0m06:02:13.321629 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.rsi_7d_snapshot
[0m06:02:13.321629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:02:13.321629 [debug] [MainThread]: Connection 'list_lab2_db' was properly closed.
[0m06:02:13.321629 [debug] [MainThread]: Connection 'list_lab2_db_snapshots' was properly closed.
[0m06:02:13.321629 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.rsi_7d_snapshot' was properly closed.
[0m06:02:13.331805 [info ] [MainThread]: 
[0m06:02:13.332310 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m06:02:13.332310 [debug] [MainThread]: Command end result
[0m06:02:13.462707 [info ] [MainThread]: 
[0m06:02:13.465722 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m06:02:13.465722 [info ] [MainThread]: 
[0m06:02:13.469737 [error] [MainThread]:   Database Error in snapshot moving_average_7d_snapshot (snapshots\moving_average_7d_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target\run\lab2_dbt\snapshots\moving_average_7d_snapshot.sql
[0m06:02:13.469737 [info ] [MainThread]: 
[0m06:02:13.472984 [error] [MainThread]:   Database Error in snapshot rsi_7d_snapshot (snapshots\rsi_7d_snapshot.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled code at target\run\lab2_dbt\snapshots\rsi_7d_snapshot.sql
[0m06:02:13.476481 [info ] [MainThread]: 
[0m06:02:13.477491 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m06:02:13.483121 [debug] [MainThread]: Command `dbt snapshot` failed at 06:02:13.481602 after 13.71 seconds
[0m06:02:13.484153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7C91BD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A7F52BFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A20F38760>]}
[0m06:02:13.485184 [debug] [MainThread]: Flushing usage events
[0m06:08:09.055102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F549BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F856FBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F856F9D0>]}


============================== 06:08:09.059135 | 7d0adb96-164c-42d6-bed1-8d9c2455ec64 ==============================
[0m06:08:09.059135 [info ] [MainThread]: Running with dbt=1.8.8
[0m06:08:09.059135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt\\logs', 'profiles_dir': 'D:\\study\\SJSU\\SEM_1\\Data_Warehouse-data_226\\Lab2\\airflow\\lab2_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:08:10.429359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d0adb96-164c-42d6-bed1-8d9c2455ec64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F5FE14B0>]}
[0m06:08:10.477018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d0adb96-164c-42d6-bed1-8d9c2455ec64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F199797730>]}
[0m06:08:10.479091 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m06:08:10.489099 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m06:08:10.778381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:08:10.778381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:08:10.834298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d0adb96-164c-42d6-bed1-8d9c2455ec64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F199B47E80>]}
[0m06:08:11.096554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d0adb96-164c-42d6-bed1-8d9c2455ec64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F826FEB0>]}
[0m06:08:11.096554 [info ] [MainThread]: Found 2 snapshots, 3 models, 7 data tests, 1 source, 454 macros
[0m06:08:11.096554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d0adb96-164c-42d6-bed1-8d9c2455ec64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F199B048E0>]}
[0m06:08:11.104061 [info ] [MainThread]: 
[0m06:08:11.104061 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:08:11.112585 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db'
[0m06:08:11.124131 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db"
[0m06:08:11.124131 [debug] [ThreadPool]: On list_lab2_db: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db"} */
show terse schemas in database lab2_db
    limit 10000
[0m06:08:11.124131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:08:12.206995 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.083 seconds
[0m06:08:12.206995 [debug] [ThreadPool]: On list_lab2_db: Close
[0m06:08:12.316680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_lab2_db_snapshots'
[0m06:08:12.324356 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_snapshots"
[0m06:08:12.324356 [debug] [ThreadPool]: On list_lab2_db_snapshots: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_snapshots"} */
show objects in lab2_db.snapshots limit 10000
[0m06:08:12.324356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:08:13.512437 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.185 seconds
[0m06:08:13.517561 [debug] [ThreadPool]: On list_lab2_db_snapshots: Close
[0m06:08:13.648753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_lab2_db_snapshots, now list_lab2_db_analytics)
[0m06:08:13.648753 [debug] [ThreadPool]: Using snowflake connection "list_lab2_db_analytics"
[0m06:08:13.648753 [debug] [ThreadPool]: On list_lab2_db_analytics: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "connection_name": "list_lab2_db_analytics"} */
show objects in lab2_db.analytics limit 10000
[0m06:08:13.654262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:08:14.685517 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.031 seconds
[0m06:08:14.688612 [debug] [ThreadPool]: On list_lab2_db_analytics: Close
[0m06:08:14.789365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d0adb96-164c-42d6-bed1-8d9c2455ec64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F522F4C0>]}
[0m06:08:14.789365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:08:14.789365 [info ] [MainThread]: 
[0m06:08:14.797878 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m06:08:14.797878 [info ] [Thread-1 (]: 1 of 2 START snapshot snapshots.moving_average_7d_snapshot ..................... [RUN]
[0m06:08:14.797878 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.lab2_dbt.moving_average_7d_snapshot'
[0m06:08:14.797878 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m06:08:14.807991 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m06:08:14.878392 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:08:14.878392 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



select
    symbol,
    date as symbol_date,
    close,
    moving_average_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.moving_average_7d

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m06:08:14.878392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:08:16.287957 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.408 seconds
[0m06:08:16.298190 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:08:16.298190 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m06:08:16.383337 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.083 seconds
[0m06:08:16.383337 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:08:16.414939 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.moving_average_7d_snapshot"
[0m06:08:16.414939 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.moving_average_7d_snapshot"} */
create or replace transient table lab2_db.snapshots.moving_average_7d_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



select
    symbol,
    date as symbol_date,
    close,
    moving_average_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.moving_average_7d

    ) sbq



        );
[0m06:08:17.349132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.931 seconds
[0m06:08:17.370234 [debug] [Thread-1 (]: On snapshot.lab2_dbt.moving_average_7d_snapshot: Close
[0m06:08:17.505706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0adb96-164c-42d6-bed1-8d9c2455ec64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19974A2F0>]}
[0m06:08:17.505706 [info ] [Thread-1 (]: 1 of 2 OK snapshotted snapshots.moving_average_7d_snapshot ..................... [[32mSUCCESS 1[0m in 2.70s]
[0m06:08:17.505706 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.moving_average_7d_snapshot
[0m06:08:17.511059 [debug] [Thread-1 (]: Began running node snapshot.lab2_dbt.rsi_7d_snapshot
[0m06:08:17.511059 [info ] [Thread-1 (]: 2 of 2 START snapshot snapshots.rsi_7d_snapshot ................................ [RUN]
[0m06:08:17.511059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.lab2_dbt.moving_average_7d_snapshot, now snapshot.lab2_dbt.rsi_7d_snapshot)
[0m06:08:17.511059 [debug] [Thread-1 (]: Began compiling node snapshot.lab2_dbt.rsi_7d_snapshot
[0m06:08:17.516592 [debug] [Thread-1 (]: Began executing node snapshot.lab2_dbt.rsi_7d_snapshot
[0m06:08:17.516592 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:08:17.516592 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



select
    symbol,
    date as symbol_date,
    rsi_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.rsi_7d

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m06:08:17.516592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:08:18.728294 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.213 seconds
[0m06:08:18.739609 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:08:18.739609 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m06:08:18.834895 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m06:08:18.834895 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:08:18.845210 [debug] [Thread-1 (]: Using snowflake connection "snapshot.lab2_dbt.rsi_7d_snapshot"
[0m06:08:18.845210 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "lab2_dbt", "target_name": "dev", "node_id": "snapshot.lab2_dbt.rsi_7d_snapshot"} */
create or replace transient table lab2_db.snapshots.rsi_7d_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(symbol_date as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



select
    symbol,
    date as symbol_date,
    rsi_7d,
    current_timestamp() as updated_at
from lab2_db.analytics.rsi_7d

    ) sbq



        );
[0m06:08:19.871327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.027 seconds
[0m06:08:19.878162 [debug] [Thread-1 (]: On snapshot.lab2_dbt.rsi_7d_snapshot: Close
[0m06:08:19.981540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0adb96-164c-42d6-bed1-8d9c2455ec64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F199DA4280>]}
[0m06:08:19.986855 [info ] [Thread-1 (]: 2 of 2 OK snapshotted snapshots.rsi_7d_snapshot ................................ [[32mSUCCESS 1[0m in 2.47s]
[0m06:08:19.986855 [debug] [Thread-1 (]: Finished running node snapshot.lab2_dbt.rsi_7d_snapshot
[0m06:08:19.986855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:08:19.986855 [debug] [MainThread]: Connection 'list_lab2_db' was properly closed.
[0m06:08:19.986855 [debug] [MainThread]: Connection 'list_lab2_db_analytics' was properly closed.
[0m06:08:19.986855 [debug] [MainThread]: Connection 'snapshot.lab2_dbt.rsi_7d_snapshot' was properly closed.
[0m06:08:19.986855 [info ] [MainThread]: 
[0m06:08:19.986855 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m06:08:19.997777 [debug] [MainThread]: Command end result
[0m06:08:20.071049 [info ] [MainThread]: 
[0m06:08:20.071049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:08:20.071049 [info ] [MainThread]: 
[0m06:08:20.071049 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:08:20.071049 [debug] [MainThread]: Command `dbt snapshot` succeeded at 06:08:20.071049 after 11.13 seconds
[0m06:08:20.071049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F549BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F601C3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F63FDC60>]}
[0m06:08:20.071049 [debug] [MainThread]: Flushing usage events
